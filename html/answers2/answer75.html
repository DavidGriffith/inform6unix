<HTML><HEAD><TITLE>Answer to Exercise 75</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE><TR><TD Valign="top"><IMG SRC="../icons/exercise.gif" ALT="??"><TD bgcolor="#FAA89B"><B>ANSWER TO EXERCISE 75</B><TR><TD><TD>
<P>


(Cf. the blackboard code in 'Toyshop'.)
<PRE>
Global from_char; Global to_char;
[ QuotedText i j f;
   i = parse-&#62;((++wn)*4-3);
   if (buffer-&#62;i=='"')
   {   for (j=i+1:j&#60;=(buffer-&#62;1)+1:j++)
           if (buffer-&#62;j=='"') f=j;
       if (f==0) return -1;
       from_char = i+1; to_char=f-1;
       if (from_char&#62;to_char) return -1;
       while (f&#62; (parse-&#62;(wn*4-3))) wn++; wn++;
       return 0;
   }
   return -1;
];
</PRE>

Note that in the case of success, the word marker <TT>wn</TT> is moved beyond the
last word accepted (since the Z-machine automatically tokenises
a double-quote as a single word).  The text is treated as though it
were a preposition, and the positions where the quoted text starts and
finishes in the raw text <TT>buffer</TT> are recorded, so that an action routine
can easily extract the text and use it later.  (Note that <TT>""</TT> with no
text inside is not matched by this routine but only because the last
<TT>if</TT> statement throws out that one case.)
</TABLE>
<HR>Back to <A HREF="../section27.html#ex75">the exercise in section 27</A><HR>
<SMALL><I>Mechanically translated to HTML from third edition as revised 16 May 1997. Copyright &#169; Graham Nelson 1993, 1994, 1995, 1996, 1997: all rights reserved.</I></SMALL></BODY></HTML>
