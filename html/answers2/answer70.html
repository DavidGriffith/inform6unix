<HTML><HEAD><TITLE>Answer to Exercise 70</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE><TR><TD Valign="top"><IMG SRC="../icons/exercise.gif" ALT="??"><TD bgcolor="#FAA89B"><B>ANSWER TO EXERCISE 70</B><TR><TD><TD>
<P>

First we must decide how to store floating-point numbers
internally: in this case we'll simply store
100<I>x</I>
to represent
<I>x</I>, so that "5.46'' will be parsed as 546.
<PRE>
[ DigitNumber n type x;
  x = NextWordStopped(); if (x==-1) return -1; wn--;
  if (type==0)
  {   x = WordAddress(wn);
      if (x-&#62;n&#62;='0' &#38;&#38; x-&#62;n&#60;='9') return (x-&#62;n) - '0';
      return -1;
  }
  if (x=='nought' or 'oh') { wn++; return 0; }
  x = TryNumber(wn++); if (x==-1000  x&#62;=10) x=-1; return x;
];
[ FloatingPoint a x b w d1 d2 d3 type;
  a = TryNumber(wn++);
  if (a==-1000) return -1;
  w = NextWordStopped(wn); if (w==-1) return a*100;
  x = NextWordStopped(wn); if (x==-1) return -1; wn--;
  if (w=='point') type=1;
  else
  {   if (WordAddress(wn-1)-&#62;0~='.'  WordLength(wn-1)~=1)
          return -1;
  }
  d1 = DigitNumber(0,type);
  if (d1==-1) return -1;
  d2 = DigitNumber(1,type); d3 = DigitNumber(2,type);
  b=d1*10; if (d2&#62;=0) b=b+d2; else d3=0;
  if (type==1)
  {   x=1; while (DigitNumber(x,type)&#62;=0) x++; wn--;
  }
  else wn++;
  parsed_number = a*100 + b;
  if (d3&#62;=5) parsed_number++;
  return 1;
];
</PRE>

</TABLE>
<HR>Back to <A HREF="../section27.html#ex70">the exercise in section 27</A><HR>
<SMALL><I>Mechanically translated to HTML from third edition as revised 16 May 1997. Copyright &#169; Graham Nelson 1993, 1994, 1995, 1996, 1997: all rights reserved.</I></SMALL></BODY></HTML>
