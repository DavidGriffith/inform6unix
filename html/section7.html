<HTML><HEAD><TITLE>Section 7: Getting started</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE><P>
<TR><TD Valign="top"><A HREF="contents.html">Contents</A><BR><A HREF="chapter3.html">Back</A><BR><A HREF="section8.html">Forward</A><TD bgcolor="#F5DEB3"><BLOCKQUOTE><H3>7. Getting started</H3></BLOCKQUOTE><TR><TD><TD>
<P>

<BLOCKQUOTE>
<BR>Nothing so difficult as a beginning
<BR>In poesy, unless perhaps the end.
<BR><P>...Lord Byron (<B>1788</B>--<B>1824</B>), <I>Don Juan, IV iv</I></BLOCKQUOTE>
<P>


The examples in Chapters III and IV of this manual will put together
a small game called 'Ruins'.  Its first state is very close to
the minimal 'Shell' game supplied with Inform:
<PRE>
Constant Story "RUINS";
Constant Headline "^An Interactive Worked Example^
             Copyright (c) 1995 by Graham Nelson.^";

Include "Parser";
Include "VerbLib";

Object Forest "Dark Forest"
  with description
          "In this tiny clearing, the pine-needle carpet is broken by
           stone-cut steps leading down into darkness.  Dark olive
           trees crowd in on all sides, the air steams with warm recent
           rain, midges hang in the air.",
  has  light;

[ Initialise;
  location = Forest;
 "^^^^^Days of searching, days of thirsty hacking through the briars of
  the forest, but at last your patience was rewarded. A discovery!^";
];

Include "Grammar";
</PRE>
<P>

If you can compile this successfully, Inform is probably set up and working
properly on your computer. Compilation may take a few seconds, because the
game 'includes' three library files which contain a great deal more code.
These files are themselves written in Inform
and contain the core of ordinary rules common to all games:

<BR><TABLE Border><TR><TD> <TT>Parser</TT>  <TD>  a program for decoding what the player types;
<TR><TD> <TT>VerbLib</TT> <TD>  how verbs, like "take'' or "drop'', work;
<TR><TD> <TT>Grammar</TT> <TD>  the grammar table, or what the Parser understands.
</TABLE>
(If compilation is annoyingly slow, it should be easy enough to "link the
library files'', which is much faster: see <A HREF="section4.html">Section 4</A>.3)  Apart from the
inclusions, 'Ruins' contains:
<P>
<P>(a) --  strings (that is, quoted text) giving the game's name and a
copyright message, to be printed out when appropriate;
<P>(b) --  a routine, called <TT>Initialise</TT>, which is run when the game begins,
and simply sets where the player starts (not that there's much choice yet!)
and prints a 'welcome' message;
<P>(c) --  an object, so far the only room.
<P>
<P> 'Ruins' is at this stage an extremely dull game:
<PRE>
Days of searching, days of thirsty hacking through the briars of the forest,
but at last your patience was rewarded. A discovery!

RUINS
An Interactive Worked Example
Copyright (c) 1995 by Graham Nelson.
Release 1 / Serial number 960825 / Inform v6.04 Library 6/1

Dark Forest
In this tiny clearing, the pine-needle carpet is broken by stone-cut steps
leading down into darkness.  Dark olive trees crowd in on all sides, the air
steams with warm recent rain, midges hang in the air.

&#62;i
You are carrying nothing.

&#62;north
You can't go that way.

&#62;wait
Time passes.

&#62;quit
Are you sure you want to quit? yes
</PRE>

<P> (The "Release'' number is 1 unless you set it otherwise,
putting a directive like <TT>Release 2;</TT> into the source code.  The
"Serial number'' is set by Inform to the date of compilation.)
<P>

<P>
In an Inform game, objects are used to simulate everything: rooms and
items to be picked up, scenery, intangible things like mist and even
some abstract ideas (like the direction 'north').  The library is
also present in every game, and can be thought of as a referee, or
umpire, rather than part of the game's world.
<P>

Our second object is added by writing the following just after the
<TT>Forest</TT> ends and just before <TT>Initialise</TT> begins:

<PRE>
Object -&#62; mushroom "speckled mushroom"
  with name "speckled" "mushroom" "fungus" "toadstool";
</PRE>

(The arrow <TT>-&#62;</TT> means that the mushroom begins inside the Forest
rather than alongside it.)  If the game is recompiled, the mushroom
is now in play: the player can call it "speckled mushroom'',
"mushroom'', "toadstool'' and so on.  It can be taken, dropped,
looked at, looked under and so on.  However, it only adds the rather
plain line "There is a speckled mushroom here.'' to the Forest's
description.  So here is a more lavish version:
<PRE>
Object -&#62; mushroom "speckled mushroom"
  with name "speckled" "mushroom" "fungus" "toadstool",
       initial
          "A speckled mushroom grows out of the sodden earth, on a long stalk.";
</PRE>

The <TT>initial</TT> message is used to tell the player about the mushroom when
the Forest is described.  (Once the mushroom has been picked or moved, the
message is no longer used: hence the name 'initial'.)  The mushroom is,
however, still "nothing special'' when the player asks to "look at'' or
"examine'' it.  To provide a more interesting close-up view, we must give
the mushroom its own <TT>description</TT>:
<PRE>
Object -&#62; mushroom "speckled mushroom"
  with name "speckled" "mushroom" "fungus" "toadstool",
       initial
          "A speckled mushroom grows out of the sodden earth, on a long stalk.",
       description
          "The mushroom is capped with blotches, and you aren't at all sure
           it's not a toadstool.",
  has  edible;
</PRE>

Now if we examine the mushroom, as is always wise before eating, we get a
cautionary hint; still, thanks to the <TT>edible</TT> notation, we're now able
to eat it.
<P>

These show the two kinds of feature something can have: a "property'',
which has some definite value or list of values (such as <TT>name</TT>), and
an "attribute'', which is either present or not but has no particular
value (such as <TT>edible</TT>).  Values of properties change during play,
and attributes come and go.  For instance,
<PRE>
        mushroom.description = "You're sure it's a toadstool now.";
        give mushroom general;
        if (mushroom has edible) print "It's definitely edible.^";
</PRE>

manipulate the attributes and properties.  (<TT>general</TT> is the name used
for an attribute with no particular meaning to the game, but which is
left free for your program to use as it likes.  Similarly, <TT>number</TT>
is a general-purpose property.)
<P>

We can go much further with form-filling like this, but for the sake of
example we'll begin some honest programming by adding the following
property to the mushroom:
<PRE>
       after
       [;  Take: "You pick the mushroom, neatly cleaving its thin stalk.";
           Drop: "The mushroom drops to the ground, battered slightly.";
       ],
</PRE>

The property <TT>after</TT> doesn't just have a string for a value: it has a
routine of its own.  Now after something happens to the mushroom,
the <TT>after</TT> routine is called to see if any special rules apply.  In this
case, <TT>Take</TT> and <TT>Drop</TT> are the only actions tampered with, and the only
effect is that the usual messages ("Taken.'' "Dropped.'') are replaced.
The game can now manage a brief but plausible dialogue:
<PRE>
Dark Forest
In this tiny clearing, the pine-needle carpet is broken by stone-cut steps
leading down into darkness.  Dark olive trees crowd in on all sides, the air
steams with warm recent rain, midges hang in the air.
A speckled mushroom grows out of the sodden earth, on a long stalk.
&#62;get mushroom
You pick the mushroom, neatly cleaving its thin stalk.
&#62;look at it
The mushroom is capped with blotches, and you aren't at all sure it's not a
toadstool.
&#62;drop it
The mushroom drops to the ground, battered slightly.
</PRE>

The mushroom is a little more convincing now, but still passive.
We can give it a somewhat sad new rule by adding yet another property,
this time with a more substantial routine:
<PRE>
       before
       [; Eat: if (random(100) &#60;= 30)
               {   deadflag = 1;
                  "The tiniest nibble is enough. It was a toadstool,
                   and a poisoned one at that!";
               }
               "You nibble at one corner, but the curious taste repels you.";
       ],
</PRE>

The <TT>before</TT> routine is called before the player's intended action takes
place.  So when the player tries typing, say, "eat the mushroom", what happens
is: in 30% of cases, she dies of toadstool poisoning; and in the other
70%, she simply nibbles a corner of fungus (without consuming it
completely).
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/dbend.gif" ALT="/\"><TD bgcolor="#EEEEEE"><SMALL> Like many programming languages, Inform braces together blocks of
code so that several statements can come under the <TT>if</TT> condition.
<TT>deadflag</TT> is a global variable, whose value does not belong to any
particular object (or routine).  It is defined somewhere in the depths of
the library: it's usually 0; setting it to 1 causes the game to be lost,
and setting it to 2 causes a win.
</SMALL>
<TR><TD><TD><P>

Note that if the first text is printed, the rule ends there, and does
not flow on into the second text.  So one and only one message is printed.
Here is how this is achieved: although it's not obvious from the look of
the program, the <TT>before</TT> routine is being asked the question
"Do you want to interfere with the usual rules?''.  It must reply,
that is, "return'', either "true'' or "false'' meaning yes or no.
Because this question is asked and answered many times in a large Inform
game, there are several abbreviations for how to reply.  For example,
<PRE>
    return true;
    rtrue;
</PRE>

both do the same thing.  Moreover,
<PRE>
    print_ret "The tiniest nibble... ...at that!";
</PRE>

performs three useful tasks: prints the message, then prints a carriage
return, and then returns true.  And this is so useful that a bare string
<PRE>
    "The tiniest nibble... ...at that!";
</PRE>
<P>

is understood to mean the same thing.  To just print the text, the
statement <TT>print</TT> has to be written out in full.  Here is an example:
<PRE>
       before
       [; Taste: print "You extend your tongue nervously.^";
                 rfalse;
       ];
</PRE>

In this rule, the text is printed, but the answer to "Do you want
to interfere?'' is no, so the game will then go on to print something
anodyne like "You taste nothing unexpected.''  (In fact the <TT>rfalse</TT>
was unnecessary, because if a rule like this never makes any
decision, then the answer is assumed to be "false''.)
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/exercise.gif" ALT="??"><TD bgcolor="#FBB9AC"><A NAME="ex1"><B>EXERCISE 1:</B><BR>(link to <A HREF="answers1/answer1.html">the answer</A>)<TR><TD><TD>  The present <TT>after</TT> routine for the mushroom is misleading,
because it says the mushroom has been picked every time it's taken (which
will be odd if it's taken, dropped then taken again).  Correct this to
complete the definition of the 'Ruins'
mushroom.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/dbend.gif" ALT="/\"><TD bgcolor="#EEEEEE"><SMALL> More generally, some <TT>before</TT> or <TT>after</TT> rules ought to apply only
once in the course of a game. For instance, examining the tapestry reveals
a key, only once.  A sneaky way to do this is to make the appropriate rule
destroy itself, so for example
<PRE>
    tapestry.before = NULL;
</PRE>

removes the entire <TT>before</TT> rule for the tapestry.  <TT>NULL</TT> is a special
value, which the properties <TT>before</TT>, <TT>after</TT>, <TT>life</TT> and <TT>describe</TT>
hold to indicate "none''.
</SMALL>
<TR><TD><TD><P>

<P>
Here is another typical object definition:
<PRE>
Object "stone-cut steps" Forest
  with name "steps" "stone" "stairs" "stone-cut",
       description
          "The cracked and worn steps descend into a dim chamber.  Yours
           might be the first feet to tread them for five hundred years.",
       door_to Square_Chamber,
       door_dir d_to
  has  scenery door open;
</PRE>

This is the conventional way to lay out an <TT>Object</TT> declaration: with the
header first, then <TT>with</TT> a list of properties and their starting values,
finishing up with the attributes it initially <TT>has</TT>.  (Though <TT>with</TT> and
<TT>has</TT> can be given the other way round.)
<P>


Note that the first line, the so-called header, is a little different
in form to those above.  Firstly, it gives no "program name'' for the
steps (in the way that <TT>mushroom</TT> was given as program-name for the
speckled mushroom) -- there is a blank in between the <TT>Object</TT> directive
and the text of the words "short-cut steps''.  This is perfectly legal,
and is sensible because the program never needs to refer to the steps
object directly.  Secondly, the initial position of the steps is specified
not by using arrows <TT>-&#62;</TT> but by actually quoting the object it is to
be placed inside, the <TT>Forest</TT>.  This is sometimes convenient and is only
legal if the <TT>Forest</TT> has already been defined (earlier on in the
program).  Such a restriction is actually useful as it prevents you from
setting up a 'loop' -- one object in another in a third in the first,
for instance.

</TABLE>
<HR><A HREF="contents.html">Contents</A> / <A HREF="chapter3.html">Back</A> / <A HREF="section8.html">Forward</A> <BR>
<A HREF="chapter1.html">Chapter I</A> / <A HREF="chapter2.html">Chapter II</A> / <A HREF="chapter3.html">Chapter III</A> / <A HREF="chapter4.html">Chapter IV</A> / <A HREF="chapter5.html">Chapter V</A> / <A HREF="chapter6.html">Chapter VI</A> / <A HREF="chapterA.html">Appendix</A><HR><SMALL><I>Mechanically translated to HTML from third edition as revised 16 May 1997. Copyright &#169; Graham Nelson 1993, 1994, 1995, 1996, 1997: all rights reserved.</I></SMALL></BODY></HTML>
