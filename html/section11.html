<HTML><HEAD><TITLE>Section 11: Containers, supporters and sub-objects</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE><P>
<TR><TD Valign="top"><A HREF="contents.html">Contents</A><BR><A HREF="section10.html">Back</A><BR><A HREF="section12.html">Forward</A><TD bgcolor="#F5DEB3"><BLOCKQUOTE><H3>11. Containers, supporters and sub-objects</H3></BLOCKQUOTE><TR><TD><TD>
<P>

<BLOCKQUOTE>
The concept of a surface is implemented as a special kind of containment.
Objects which have surfaces on which other objects may sit are actually
containers with an additional property of "surfaceness".
<P>...P. David Lebling, <I>Zork and the Future</I></BLOCKQUOTE>
<P>

<BLOCKQUOTE>
The year has been a good one for the Society <I> (hear, hear)</I>.
This year our members have put more things on top of other things
than ever before.  But, I should warn you, this is no time for
complacency.  No, there are still many things, and I cannot
emphasize this too strongly, <I> not</I> on top of other things.
<P>...'The Royal Society For Putting Things On Top Of
Other Things', <I> Monty Python's Flying Circus</I>,
programme <B>18</B> (<B>1970</B>)</BLOCKQUOTE>

<P>


Objects can be inside or on top of one another.  An object which has the
<TT>container</TT> attribute can contain things, like a box: one which has
<TT>supporter</TT> can hold them up, like a table.  (An object can't have both at
once.)  It can hold up to 100 items, by default: this is set by the <TT>capacity</TT>
property.
However, one can only put things inside a container when it has <TT>open</TT>.
If it has <TT>openable</TT>, the player can open and close it at will, unless
it also has <TT>locked</TT>.  A <TT>locked</TT> object (whether it be a door or a
container) cannot be opened.  But if it has <TT>lockable</TT> then it can be
locked or unlocked with the key object given in the <TT>with_key</TT> property.
If <TT>with_key</TT> is undeclared, then no key will fit, but this will not be told
to the player, who can try as many as he likes.
<P>

Containers (and supporters) are able to react to things being put inside
them, or removed from them, by acting on the signal to <TT>Receive</TT> or
<TT>LetGo</TT>.  For example, deep under the 'Ruins' is a chasm which,
perhaps surprisingly, is implemented as a container:
<PRE>
Object -&#62; chasm "horrifying chasm"
  with name "blackness" "chasm" "pit" "depths" "horrifying" "bottomless",
       react_before
       [;  Jump: &#60;&#60;Enter self&#62;&#62;;
           Go: if (noun==d_obj) &#60;&#60;Enter self&#62;&#62;;
       ],
       before
       [;  Enter: deadflag=1;
              "You plummet through the silent void of darkness!";
       ],
       after
       [;  Receive: remove noun;
               print_ret (The) noun, " tumbles silently into the
                   darkness of the chasm.";
           Search: "The chasm is deep and murky.";
       ],
  has  scenery open container;
</PRE>

(Actually the definition is a little longer, so that the chasm reacts to a
huge pumice-stone ball being rolled into it; see 'Ruins'.)  Note the use of
an <TT>after</TT> rule for the <TT>Search</TT> action: this is because an attempt to
"examine'' or "look inside'' the chasm will cause this action. 
<TT>Search</TT> means, in effect, "tell me what is inside the container'' and the
<TT>after</TT> rule prevents a message like "There is nothing inside the chasm.''
from misleading the player.  Note also that the chasm 'steals' any stray
<TT>Jump</TT> action and converts it into an early death.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/exercise.gif" ALT="??"><TD bgcolor="#FBB9AC"><A NAME="ex9"><B>EXERCISE 9:</B><BR>(link to <A HREF="answers1/answer9.html">the answer</A>)<TR><TD><TD> Make the following, rather acquisitive bag:
<PRE>
&#62;put fish in bag
The bag wriggles hideously as it swallows the fish.
&#62;get fish
The bag defiantly bites itself shut on your hand until you desist.
</PRE>

<P>

<P><TR><TD Valign="top"><IMG SRC="icons/dbend.gif" ALT="/\"><TD bgcolor="#EEEEEE"><SMALL> <TT>LetGo</TT> and <TT>Receive</TT> are examples of actions which aren't
explicitly requested by the player, but are generated by the game in the
course of play (so-called "fake actions'').
</SMALL>
<TR><TD><TD><P>

<P><TR><TD Valign="top"><IMG SRC="icons/dbend.gif" ALT="/\"><TD bgcolor="#EEEEEE"><SMALL> <TT>Receive</TT> is sent to an object <I>O</I> both when a player tries to put
something in <I>O</I>, and put something on <I>O</I>.  In the rare event that <I>O</I>
needs to react differently to these, it may consult the variable
<TT>receive_action</TT> to find out whether <TT>##PutOn</TT> or <TT>##Insert</TT> is the
cause.
</SMALL>
<TR><TD><TD><P>


The 'Ruins' packing case is a typical container:
<PRE>
Object -&#62; packing_case "packing case"
  with name "packing" "case" "box" "strongbox",
       initial
          "Your packing case rests here, ready to hold any important
           cultural finds you might make, for shipping back to civilisation.",
       before
       [;  Take, Remove, PushDir:
              "The case is too heavy to bother moving, as long as your
               expedition is still incomplete.";
       ],
  has  static container open;
</PRE>

<P>


Now suppose we want a portable television set with four different
buttons on it.  Obviously, when the television moves, its buttons
should move with it, and the sensible way to arrange this is to make the
four buttons possessions of the <TT>television</TT> object.  But members of
an object which isn't a container are normally assumed by the game to
be hidden invisibly inside (they are said to be "not in scope'').  We
have to override this in order to make the four buttons visible from
outside, by giving the television the <TT>transparent</TT> attribute.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/exercise.gif" ALT="??"><TD bgcolor="#FBB9AC"><A NAME="ex10"><B>EXERCISE 10:</B><BR>(link to <A HREF="answers1/answer10.html">the answer</A>)<TR><TD><TD> Implement a television set with attached power button and
screen.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/exercise.gif" ALT="??"><TD bgcolor="#FBB9AC"><A NAME="ex11"><B>EXERCISE 11:</B><BR>(link to <A HREF="answers1/answer11.html">the answer</A>)<TR><TD><TD> Make a glass box and a steel box, which would behave
differently when a lamp is shut up inside
them.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/dbend.gif" ALT="/\"><TD bgcolor="#EEEEEE"><SMALL> It sometimes happens that an object should have sub-objects,
like lamps and buttons, as well as possessions, in which case the
above solution is unsatisfactory.  Fuller details will be given in the
"scope addition'' rules in <A HREF="section28.html">Section 28</A>, but briefly: an
object's <TT>add_to_scope</TT> property may contain a list of sub-objects
to be kept attached to it (and these sub-objects don't count as
possessions).
</SMALL>
<TR><TD><TD><P>

<P><TR><TD Valign="top"><IMG SRC="icons/exercise.gif" ALT="??"><TD bgcolor="#FBB9AC"><A NAME="ex12"><B>EXERCISE 12:</B><BR>(link to <A HREF="answers1/answer12.html">the answer</A>)<TR><TD><TD> Implement a macram&#232; bag hanging from the ceiling, inside
which objects are visible (and audible, etc.) but cannot be touched or
manipulated in any way.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/refs.gif" ALT="*"><TD bgcolor="#EEEEEE"><B>REFERENCES:</B><BR><SMALL>  Containers and supporters abound in the example games
(except 'Advent', which is too simple, though see the
water-and-oil carrying bottle).  Interesting containers include
the lottery-board and the podium sockets from 'Balances' and
the 'Adventureland' bottle.
<BR>
For supporters, the hearth-rug, chessboard, armchair and mantelpiece
of 'Alice Through The Looking-Glass' are typical examples; the
mantelpiece and spirit level of 'Toyshop' make a simple puzzle,
and the pile of building blocks a complicated one; see also the
scales in 'Balances'.
</TABLE>
<HR><A HREF="contents.html">Contents</A> / <A HREF="section10.html">Back</A> / <A HREF="section12.html">Forward</A> <BR>
<A HREF="chapter1.html">Chapter I</A> / <A HREF="chapter2.html">Chapter II</A> / <A HREF="chapter3.html">Chapter III</A> / <A HREF="chapter4.html">Chapter IV</A> / <A HREF="chapter5.html">Chapter V</A> / <A HREF="chapter6.html">Chapter VI</A> / <A HREF="chapterA.html">Appendix</A><HR><SMALL><I>Mechanically translated to HTML from third edition as revised 16 May 1997. Copyright &#169; Graham Nelson 1993, 1994, 1995, 1996, 1997: all rights reserved.</I></SMALL></BODY></HTML>
