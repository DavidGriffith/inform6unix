<HTML><HEAD><TITLE>Section 20: Miscellaneous constants and scoring</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE><P>
<TR><TD Valign="top"><A HREF="contents.html">Contents</A><BR><A HREF="section19.html">Back</A><BR><A HREF="section21.html">Forward</A><TD bgcolor="#F5DEB3"><BLOCKQUOTE><H3>20. Miscellaneous constants and scoring</H3></BLOCKQUOTE><TR><TD><TD>
<P>

<BLOCKQUOTE>
<BR>For when the One Great Scorer comes
<BR>To write against your name,
<BR>He marks -- not that you won or lost --
<BR>But how you played the game.
<BR><P>...Grantland Rice (<B>1880</B>--<B>1954</B>), <I>Alumnus Football</I></BLOCKQUOTE>
<P>


Some game rules can be altered by defining 'constants' at the start of
the program.  Two constants you <I> must</I> provide (and before including
any of the library files) are the strings <TT>Story</TT> and <TT>Headline</TT>:
<PRE>
Constant Story "ZORK II";
Constant Headline "^An Interactive Plagiarism^
             Copyright (c) 1995 by Ivan O. Ideas.^";
</PRE>

All the rest are optional, but should be defined before <TT>Verblib</TT>
is included if they're to take effect.
<P>

<P>
The library won't allow the player to carry an indefinite number of
objects: the limit allowed is the constant <TT>MAX_CARRIED</TT>, which you
may define if you wish.  If you don't define it, it's 100, which
nearly removes the rule.  In fact you can change this during play,
since it is actually the <TT>capacity</TT> of the <TT>player</TT> which is
consulted; the only use of <TT>MAX_CARRIED</TT> is to set this up to
an initial value.
<P>

If you define <TT>SACK_OBJECT</TT> to be some container, then the player will
automatically put old, least-used objects away in it as the game
progresses, provided it is being carried.  This is a feature which
endears the designer greatly to players.  For instance,
the following code appears (in between inclusion of <TT>Parser</TT>
and <TT>Verblib</TT>) in 'Toyshop':
<PRE>
Object satchel "satchel"
  with description "Big and with a smile painted on it.",
       name "satchel", article "your",
       when_closed "Your satchel lies on the floor.",
       when_open "Your satchel lies open on the floor.",
  has  container open openable;
Constant SACK_OBJECT satchel;
</PRE>

'Ruins' isn't going to provide this feature, because there
are few portable objects and those there are would be incongruous
if described as being in a rucksack.
<P>

<P>
Another constant is <TT>AMUSING_PROVIDED</TT>.  If you define this, the library
knows to put an "amusing" option on the menu after the game is won.
It will then call <TT>Amusing</TT> from your code when needed.  You can
use this to roll closing credits, or tell the player various strange
things about the game, now that there's no surprise left to spoil.

<P>

<P>
The other constants you are allowed to define help the score routines
along.  There are two scoring systems provided by the library, side by
side: you can use both or neither.  You can always do what you like to
the <TT>score</TT> variable in any case, though the "fullscore'' verb might
then not fully account for what's happened.
One scores points for getting certain
items or reaching certain places; the other for completing certain
actions.  These constants are:

<BR><TABLE Border><TR><TD><TT>MAX_SCORE</TT> <TD> the maximum game score (by default 0);
<TR><TD><TT>NUMBER_TASKS</TT> <TD> number of individual "tasks" to perform (1);
<TR><TD><TT>OBJECT_SCORE</TT> <TD> bonus for first picking up a <TT>scored</TT> object (4);
<TR><TD><TT>ROOM_SCORE</TT> <TD> bonus for first entering a <TT>scored</TT> room (5)
</TABLE>
and then the individual tasks have scores, as follows:
<PRE>
Array task_scores -&#62; t1 t2 ... tn;
</PRE>

As this is a byte array, the task scores must be between 0 and 255.
Within your code, when a player achieves something, call <TT>Achieved(task)</TT>
to mark that the task has been completed.  It will only award points if
this task has not been completed before.  There do not have to be any
"tasks": there's no need to use the scoring system provided.  Tasks
(and the verb "full" for full score) will only work at all if you define
the constant <TT>TASKS_PROVIDED</TT>.
The entry point <TT>PrintTaskName</TT> prints the name of a game task (but, of
course, is only ever called in a game with <TT>TASKS_PROVIDED</TT> defined).
For instance, ('Toyshop' again)
<PRE>
[ PrintTaskName ach;
  switch(ach)
  {   0: "eating a sweet";
      1: "driving the car";
      2: "shutting out the draught";
      3: "building a tower of four";
      4: "seeing which way the mantelpiece leans";
  }
];
</PRE>


Another entry point, called <TT>PrintRank</TT>, gets the chance to print
something additional to the score (traditionally, though not
necessarily, rankings).  For instance, we bid farewell to the
'Ruins' with the following:
<PRE>
[ PrintRank;
  print ", earning you the rank of ";
  switch(score)
  {   0 to 9:   "humble rainforest Tourist.";
      10 to 19: "Investigator.";
      20 to 29: "Acquisitor.";
      30 to 49: "Archaeologist.";
      50:       "Master Archaeologist.";
  }
];
</PRE>
<P>

<P>

Normally, an Inform game will print messages like
<BLOCKQUOTE>
[Your score has gone up by three points.]
</BLOCKQUOTE>

when the score changes (by whatever means).  The player can turn this on and
off with the "notify'' verb; by default it is on.  (You can alter the flag
<TT>notify_mode</TT> yourself to control this.)
<P>

The verbs "objects'' and "places'' are usually provided, so the player
can get a list of all handled objects (and where they now are), and all
places visited.  If you don't want these to be present, define the constant
<TT>NO_PLACES</TT> before inclusion of the
library.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/dexercise.gif" ALT="??/\"><TD bgcolor="#FBB9AC"><A NAME="ex46"><B>EXERCISE 46:</B><BR>(link to <A HREF="answers1/answer46.html">the answer</A>)<TR><TD><TD> Suppose one single room object is used internally for the
64 squares of a gigantic chessboard, each of which is a different location
to the player.  Then "places'' is likely to result in only the last-visited
square being listed.  Fix this.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/refs.gif" ALT="*"><TD bgcolor="#EEEEEE"><B>REFERENCES:</B><BR><SMALL>  'Advent' contains ranks and an <TT>Amusing</TT> reward (but doesn't use
either of these scoring systems, instead working by hand).
<BR>
'Balances' uses <TT>scored</TT> objects (for its cubes).
<BR>
'Toyshop' has tasks, as above.
<BR>
'Adventureland' uses its <TT>TimePasses</TT> entry point to recalculate the
score every turn (and watch for victory).
</TABLE>
<HR><A HREF="contents.html">Contents</A> / <A HREF="section19.html">Back</A> / <A HREF="section21.html">Forward</A> <BR>
<A HREF="chapter1.html">Chapter I</A> / <A HREF="chapter2.html">Chapter II</A> / <A HREF="chapter3.html">Chapter III</A> / <A HREF="chapter4.html">Chapter IV</A> / <A HREF="chapter5.html">Chapter V</A> / <A HREF="chapter6.html">Chapter VI</A> / <A HREF="chapterA.html">Appendix</A><HR><SMALL><I>Mechanically translated to HTML from third edition as revised 16 May 1997. Copyright &#169; Graham Nelson 1993, 1994, 1995, 1996, 1997: all rights reserved.</I></SMALL></BODY></HTML>
