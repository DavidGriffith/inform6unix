<HTML><HEAD><TITLE>Answer to Exercise 87</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE><TR><TD Valign="top"><IMG SRC="../icons/exercise.gif" ALT="??"><TD bgcolor="#FAA89B"><B>ANSWER TO EXERCISE 87</B><TR><TD><TD>
<P>


Firstly, create an attribute <TT>is_key</TT> and give it to all the keys in
the game.  Then:
<PRE>
Global assumed_key;
[ DefaultLockSub;
  print "(with ", (the) assumed_key, ")^"; &#60;&#60;Lock noun assumed_key&#62;&#62;;
];
[ DefaultLockTest i count;
  if (noun hasnt lockable) rfalse;
  objectloop (i in player)
      if (i has is_key) { count++; assumed_key = i; }
  if (count==1) rtrue; rfalse;
];
Extend "lock" first * noun = DefaultLockTest -&#62; DefaultLock;
</PRE>

(and similar code for "unlock'').  Note that "lock strongbox''
is matched by this new grammar line only if the player only has one
key: the <TT>DefaultLock strongbox</TT> action is generated: which is
converted to, say, <TT>Lock strongbox brass_key</TT>.
</TABLE>
<HR>Back to <A HREF="../section29.html#ex87">the exercise in section 29</A><HR>
<SMALL><I>Mechanically translated to HTML from third edition as revised 16 May 1997. Copyright &#169; Graham Nelson 1993, 1994, 1995, 1996, 1997: all rights reserved.</I></SMALL></BODY></HTML>
