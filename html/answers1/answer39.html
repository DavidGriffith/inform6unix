<HTML><HEAD><TITLE>Answer to Exercise 39</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE><TR><TD Valign="top"><IMG SRC="../icons/exercise.gif" ALT="??"><TD bgcolor="#FAA89B"><B>ANSWER TO EXERCISE 39</B><TR><TD><TD>
<P>


A minimal solution is as follows:
<PRE>
Constant SUNRISE  360;  ! i.e., 6 am
Constant SUNSET  1140;  ! i.e., 7 pm
Attribute outdoors;     ! Give this to external locations
Attribute lit;          ! And this to artificially lit ones
Global day_state = 2;
[ TimePasses f obj;
  if (the_time &#62;= SUNRISE &#38;&#38; the_time &#60; SUNSET) f=1;
  if (day_state == f) rfalse;
  objectloop (obj)
  {   if (obj has lit) give obj light;
      if (obj has outdoors &#38;&#38; obj hasnt lit)
      {   if (f==0) give obj ~light; else give obj light;
      }
  }
  if (day_state==2) { day_state = f; return; }
  day_state = f; if (location hasnt outdoors) return;
  if (f==1) "^The sun rises, illuminating the landscape!";
 "^As the sun sets, the landscape is plunged into darkness.";
];
</PRE>

In the <TT>Initialise</TT> routine, set the time (using <TT>SetTime</TT>)
and then call <TT>TimePasses</TT> to set all the <TT>light</TT> attributes
accordingly.  Note that with this system, there's no need to
set <TT>light</TT> at all: that's automatic.
</TABLE>
<HR>Back to <A HREF="../section18.html#ex39">the exercise in section 18</A><HR>
<SMALL><I>Mechanically translated to HTML from third edition as revised 16 May 1997. Copyright &#169; Graham Nelson 1993, 1994, 1995, 1996, 1997: all rights reserved.</I></SMALL></BODY></HTML>
