<HTML><HEAD><TITLE>Section 32: Boxes, menus and drawings</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE><P>
<TR><TD Valign="top"><A HREF="contents.html">Contents</A><BR><A HREF="section31.html">Back</A><BR><A HREF="section33.html">Forward</A><TD bgcolor="#F5DEB3"><BLOCKQUOTE><H3>32. Boxes, menus and drawings</H3></BLOCKQUOTE><TR><TD><TD>
<P>

<BLOCKQUOTE>
Yes, all right, I won't do the menu... I don't think you realise
how long it takes to do the menu, but no, it doesn't matter, I'll
hang the picture now.  If the menus are late for lunch it doesn't
matter, the guests can all come and look at the picture till they
are ready, right?
<P>...John Cleese and Connie Booth, <I>Fawlty Towers</I></BLOCKQUOTE>
<P>

<P>
One harmless effect, though not very special, is to ask the player
a yes/no question.  To do this, print up the question and then
call the library routine <TT>YesOrNo</TT>, which returns true/false
accordingly.
<P>

The status line is perhaps the most distinctive feature of Infocom games in
play.  This is the (usually highlighted) bar across the top of the screen. 
Usually, the game automatically prints the current game location, and either
the time or the score and number of turns taken.  It has the score/turns
format unless the directive
<PRE>
Statusline time;
</PRE>

has been written in the program, in which case the game's 24-hour clock is
displayed.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/dbend.gif" ALT="/\"><TD bgcolor="#EEEEEE"><SMALL> If you want to change this, just <TT>Replace</TT> the parser's
private <TT>DrawStatusLine</TT> routine.  This requires a little assembly
language: see the next section for numerous examples.
</SMALL>
<TR><TD><TD><P>


About character graphic drawings: on some machines, text will by default
be displayed in a proportional font (i.e., one in which the width of a letter
depends on what it is, so that for example an 'i' will be narrower than an
'm').  If you want to display a diagram made up of letters, such as a map,
the spacing may then be wrong.  The statement <TT>font off</TT> ensures that any
fancy font is switched off and that a fixed-pitch one is being used: after
this, <TT>font on</TT> restores the usual state.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/warning.gif" ALT="!!"><TD><B>WARNING:</B><BR> Don't turn the <TT>font</TT> on and off in the middle of a line; this
doesn't look right on some machines.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/dbend.gif" ALT="/\"><TD bgcolor="#EEEEEE"><SMALL> When trying to produce a character-graphics drawing, you sometimes
want to produce the <TT>\</TT> character, one of the four "escape characters''
which can't normally be included in text.  A double <TT>@</TT> sign followed by
a number includes the character with that ASCII code; thus:
<BLOCKQUOTE>
<TT>@@64</TT> produces the literal character <TT>@</TT><BR>
<TT>@@92</TT> produces <TT>\</TT><SAMP>            </SAMP> <TT>@@94</TT> produces <TT>^</TT>
<SAMP>            </SAMP> <TT>@@126</TT> produces <TT>~</TT><BR>
</BLOCKQUOTE>


</SMALL>
<TR><TD><TD><P>

<P><TR><TD Valign="top"><IMG SRC="icons/ddbend.gif" ALT="/\/\"><TD bgcolor="#EEEEEE"><SMALL> Some interpreters are capable of much better character graphics
(those equipped to run the Infocom game 'Beyond Zork', for instance).
There is a way to find out if this feature is provided and to make
use of it: see the <I> Z-Machine Standards Document</I>.
</SMALL>
<TR><TD><TD><P>

<P><TR><TD Valign="top"><IMG SRC="icons/ddbend.gif" ALT="/\/\"><TD bgcolor="#EEEEEE"><SMALL> A single <TT>@</TT> sign is also an escape character.  It must be
followed by a 2-digit decimal number between 0 and 31 (for instance,
<TT>@05</TT>).  What this prints is the <I>n</I>-th 'variable string'.  This feature
is not as useful as it looks, since the only legal values for such
a variable string are strings declared in advance by a <TT>LowString</TT>
directive.  The <TT>String</TT> statement then sets the <I>n</I>-th variable
string.  For details and an example, see the answer to the east-west
reversal exercise in <A HREF="section10.html">Section 10</A>.
</SMALL>
<TR><TD><TD><P>

<P>
A distinctive feature of later Infocom games was their use of epigrams.
The assembly language required to produce this effect is easy but a
nuisance, so there is an Inform statement to do it, <TT>box</TT>.  For example,
<PRE>
box "I might repeat to myself, slowly and soothingly,"
    "a list of quotations beautiful from minds profound;"
    "if I can remember any of the damn things."
    ""
    "-- Dorothy Parker";
</PRE>

Note that a list of one or more lines is given (without intervening commas)
and that a blank line is given by a null string.  Remember that the text
cannot be too wide or it will look awful on a small screen.  Inform
will automatically insert the boxed text into the game transcript,
if one is being made.
The author takes the view that this device is amusing for irrelevant
quotations but irritating when it conveys vital information (such as
"Beware of the Dog").  Also, some people might be running
your game on a laptop with a vertically challenged screen, so it is
polite to provide a "quotes off'' verb.
<P>

A snag with printing boxes is that if you do it in the middle of a turn
then it will probably scroll half-off the screen by the time the game
finishes printing for the turn.  The right time to do so is just after
the prompt (usually <TT>&#62;</TT>) is printed, when the screen will definitely
scroll no more.  You could use the <TT>Prompt:</TT> slot in <TT>LibraryMessages</TT>
to achieve this, but a more convenient way is to put your box-printing
into the entry point <TT>AfterPrompt</TT> (called at this time each
turn).
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/exercise.gif" ALT="??"><TD bgcolor="#FBB9AC"><A NAME="ex88"><B>EXERCISE 88:</B><BR>(link to <A HREF="answers2/answer88.html">the answer</A>)<TR><TD><TD> Implement a routine <TT>Quote(n)</TT> which will arrange for the
<I>n</I>-th quotation (where
0 &#60;= n &#60;= 49
) to be displayed at the end
of this turn, provided it hasn't been quoted
before.
<P>

<P>

Sometimes one would like to provide a menu of text options (for instance,
when producing instructions which have several topics, or when giving
clues).  This can be done with the <TT>DoMenu</TT> routine, which imitates
the traditional "Invisiclues'' style.  By setting <TT>pretty_flag=0</TT> you
can make a simple text version instead; a good idea for machines
with very small screens.
Here is a typical call to <TT>DoMenu</TT>:
<PRE>
DoMenu("There is information provided on the following:^
        ^     Instructions for playing
        ^     The history of this game
        ^     Credits^",
        HelpMenu, HelpInfo);
</PRE>

Note the layout, and especially the carriage returns.  The second and
third arguments are themselves routines.  (Actually the first argument
can also be a routine to print a string instead of the string itself,
which might be useful for adaptive hints.)  The <TT>HelpMenu</TT> routine
is supposed to look at the variable <TT>menu_item</TT>.  In the case when this
is zero, it should return the number of entries in the menu (3 in the
example).  In any case it should set <TT>item_name</TT> to the title for the
page of information for that item; and <TT>item_width</TT> to half its length
in characters (this is used to centre titles on the screen).
In the case of item 0, the title should be that for the whole
menu.
<P>

The second routine, <TT>HelpInfo</TT> above, should simply look at <TT>menu_item</TT>
(1 to 3 above) and print the text for that selection.  After this returns,
normally the game prints "Press [Space] to return to menu'' but if
the value 2 is returned it doesn't wait, and if the value 3 is returned
it automatically quits the menu as if Q had been pressed.  This is useful
for juggling submenus about.
<P>

Menu items can safely launch whole new menus, and it is easy to make
a tree of these (which will be needed when it comes to providing hints
across any size of game).
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/exercise.gif" ALT="??"><TD bgcolor="#FBB9AC"><A NAME="ex89"><B>EXERCISE 89:</B><BR>(link to <A HREF="answers2/answer89.html">the answer</A>)<TR><TD><TD> Code an "Invisiclues''-style sequence of hints for a puzzle,
revealed one at a time, as a menu item.
<P>

<P>
Finally, you can change the text style.  The statement for this is
<TT>style</TT> and its effects are loosely modelled on the VT100 (design of
terminal). The style can be <TT>style roman</TT>, <TT>style bold</TT>, <TT>style reverse</TT> or
<TT>style underline</TT>.  Again, poor terminals may not be able to display these,
so you shouldn't hide crucial information in them.
<P>

<P><TR><TD Valign="top"><IMG SRC="icons/refs.gif" ALT="*"><TD bgcolor="#EEEEEE"><B>REFERENCES:</B><BR><SMALL>  'Advent' contains a menu much like that above.
<BR>
The "Infoclues'' utility program translates UHS format hints
(a standard, easy to read and write layout) into an Inform file of calls to
<TT>DoMenu</TT> which can simply be included into a game; this saves a good deal of
trouble.  
</TABLE>
<HR><A HREF="contents.html">Contents</A> / <A HREF="section31.html">Back</A> / <A HREF="section33.html">Forward</A> <BR>
<A HREF="chapter1.html">Chapter I</A> / <A HREF="chapter2.html">Chapter II</A> / <A HREF="chapter3.html">Chapter III</A> / <A HREF="chapter4.html">Chapter IV</A> / <A HREF="chapter5.html">Chapter V</A> / <A HREF="chapter6.html">Chapter VI</A> / <A HREF="chapterA.html">Appendix</A><HR><SMALL><I>Mechanically translated to HTML from third edition as revised 16 May 1997. Copyright &#169; Graham Nelson 1993, 1994, 1995, 1996, 1997: all rights reserved.</I></SMALL></BODY></HTML>
