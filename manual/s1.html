<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>DM4 &#167;1: Routines</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="dm4.css">
</head>
<body>
<p class="navbar">
 <a href="index.html">home</a> /
 <a href="contents.html">contents</a> /
 <a href="ch1.html" title="Chapter I: The Inform Language">chapter I</a> /
 <a href="ch1.html" title="Chapter I: The Inform Language">prev</a> /
 <a href="s2.html" title="&#167;2: The state of play">next</a> /
 <a href="dm4index.html">index</a>
</p>

<div class="page">
<a id="p15" name="p15"></a>
<h2>&#167;1 &nbsp; Routines</h2>

<p class="normal"><span class="atleft"><img src="dm4-015_1.jpg" alt=""></span>
If you have already dipped into <a href="ch2.html">Chapter II</a> and looked at how some
simple games and puzzles are designed, you'll have seen that 
any really interesting item needs to be given instructions on how 
to behave, and that these instructions are written in a language 
of their own. <a href="ch1.html">Chapter I</a> is about that 
language, and its examples are mostly short
programs to carry out mundane tasks, undistracted by the lure of 
adventure.</p>

<a id="s1_1" name="s1_1"></a>
<h3>&#167;1.1 &nbsp; Getting started</h3>

<p class="normal">Inform turns your description of a game (or other program), called the 
&#8220;source code&#8221;, into a &#8220;story file&#8221; which can be played (or run through) 
using an &#8220;interpreter&#8221;. Interpreter programs are available for very many 
models of computer, and if you can already play Infocom's games or other 
people's Inform games on your machine then you already have an interpreter. 
There are several interpreter programs available, in a sort of friendly 
rivalry. You should be able to use whichever you prefer and even the oldest, most 
rickety interpreter will probably not give serious trouble. A good sign to 
look out for is compliance with the exacting Z-Machine Standards Document, agreed by an
informal committee of interested parties between 1995 and 1997. At 
time of writing, the current version is Standard 1.0, dating from June 
1997.</p>
<p class="indent">Turning source code into a story file is called &#8220;compilation&#8221;, and 
Inform itself is the compiler. It's also supplied with a whole slew of 
ready-made source code called the &#8220;library&#8221; and giving all the rules for adventure 
games. The story of what the library does and how to work with it occupies most 
of this manual, but not this chapter.</p>

<a id="p16" name="p16"></a>
<p class="indent">It isn't practicable to give installation instructions here, because they vary
so much from machine to machine, but before you can go any further you'll
need to install Inform: try downloading the software for your own machine
from <tt>ftp.gmd.de</tt>, which should either install itself or give instructions. 
A useful test exercise would be to try to create the &#8220;Hello World&#8221; source code
given below, then to compile it with Inform, and finally &#8220;play&#8221; it on your
interpreter. (You can type up source code with any text editor or even with a
word-processor, provided you save its documents as &#8220;text only&#8221;.)</p>

<p class="indent">Inform can run in a number of slightly different ways, controlled by
&#8220;switches&#8221;. The way to set these varies from one installation to another.
Note that this chapter assumes that you're running Inform in &#8220;Strict mode&#8221;,
controlled by the <tt>-S</tt> switch, which is normally set and ensures that helpful
error messages will be printed if a story file you have compiled does something
it shouldn't.</p>

<a id="s1_2" name="s1_2"></a>
<h3>&#167;1.2 &nbsp; Hello World</h3>

<p class="normal">Traditionally, all programming language tutorials begin by giving a program
which does nothing but print &#8220;Hello world&#8221; and stop. Here it is in Inform:</p>

<p class="lynxonly"></p>
<pre class="code">
!  &quot;Hello world&quot; example program
[ Main;
  print &quot;Hello world^&quot;;
];
</pre>

<p class="normal">The text after the exclamation mark is a &#8220;comment&#8221;, that is, it is text written
in the margin by the author to remind himself of what is going on here. Such
text means nothing to Inform, which ignores anything on the same line and
to the right of an exclamation mark. In addition, any gaps made up of line
and page breaks, tab characters and spaces are treated the same and called
&#8220;white space&#8221;, so the layout of the source code doesn't much matter. Exactly
the same story file would be produced by:</p>

<p class="lynxonly"></p>
<pre class="code">
   [
      Main   ;
print
         &quot;Hello world^&quot;        ;
     ]
 ;
</pre>

<a id="p17" name="p17"></a>
<p class="normal">or, at the other extreme, by:</p>

<p class="lynxonly"></p>
<pre class="code">
[Main;print&quot;Hello world^&quot;;];
</pre>

<p>Laying out programs legibly is a matter of personal taste.</p>

<p class="aside"><span class="warning">&#9650;</span>
The exception to the rule about ignoring white space is inside quoted text, where
<code>&quot;Hello&nbsp;&nbsp;&nbsp;&nbsp;world^&quot;</code> and <code>&quot;Hello&nbsp;world^&quot;</code>
are genuinely different pieces of text and are treated 
as such. Inform treats text inside quotation marks with much more care than its
ordinary program material: for instance, an exclamation mark inside quotation marks
will not cause the rest of its line to be thrown away as a comment.</p>

<p class="indent">Inform regards its source code as a list of things to look at, divided up by
semicolons <code>;</code>. These things are generally objects, of which more later. In this
case there is only one, called <code>Main</code>, and it's of a special kind called a &#8220;routine&#8221;.</p>

<p class="indent">Every program has to contain a routine called <code>Main</code>. When a story file is
set running the interpreter follows the first instruction in <code>Main</code>, and it carries
on line by line from there. This process is called &#8220;execution&#8221;. Once the <code>Main</code>
routine is finished, the interpreter stops.</p>

<p class="indent">These instructions are called &#8220;statements&#8221;, a traditional term in computing 
albeit an ungrammatical one. In this case there is only one statement:</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;Hello world^&quot;;
</pre>

<p class="normal">Printing is the process of writing text onto the computer screen. This statement
prints the two words &#8220;Hello world&#8221; and then skips the rest of the line (or &#8220;prints
a new-line&#8221;), because the <code>^</code> character, in quoted text, means &#8220;new-line&#8221;. For
example, the statement</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;Blue^Red^Green^&quot;;
</pre>

<p class="normal">prints up:</p>

<p class="output">Blue<br>Red<br>Green</p>

<p class="normal"><code>print</code> is one of 28 different statements in the Inform language. Only about 20
of these are commonly used, but the full list is as follows:</p>

<p class="lynxonly"></p>
<table style="margin-left:30px"><tr>
<td width="15%"><code>box</code></td>
<td width="15%"><code>break</code></td>
<td width="15%"><code>continue</code></td>
<td width="15%"><code>do</code></td>
<td width="15%"><code>font</code></td>
<td width="15%"><code>for</code></td>
</tr><tr>
<td><code>give</code></td>
<td><code>if</code></td>
<td><code>inversion</code></td>
<td><code>jump</code></td>
<td><code>move</code></td>
<td><code>new_line</code></td>
</tr><tr>
<td><code>objectloop</code></td>
<td><code>print</code></td>
<td><code>print_ret</code></td>
<td><code>quit</code></td>
<td><code>read</code></td>
<td><code>remove</code></td>
</tr><tr>
<td><code>restore</code></td>
<td><code>return</code></td>
<td><code>rfalse</code></td>
<td><code>rtrue</code></td>
<td><code>save</code></td>
<td><code>spaces</code></td>
</tr><tr>
<td><code>string</code></td>
<td><code>style</code></td>
<td><code>switch</code></td>
<td><code>while</code></td>
</tr></table>

<a id="p18" name="p18"></a>
<a id="s1_3" name="s1_3"></a>
<h3>&#167;1.3 &nbsp; Routine calls, errors and warnings</h3>

<p class="normal">The following source code has three routines, <code>Main</code>,
<code>Rosencrantz</code> and <code>Hamlet</code>:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main;
  print &quot;Hello from Elsinore.^&quot;;
  Rosencrantz();
];
[ Rosencrantz;
  print &quot;Greetings from Rosencrantz.^&quot;;
];
[ Hamlet;
  print &quot;The rest is silence.^&quot;;
];
</pre>

<p>The resulting program prints up</p>

<p class="output">Hello from Elsinore.<br>
Greetings from Rosencrantz.</p>

<p class="normal">but the text &#8220;The rest is silence.&#8221; is never printed. 
Execution begins at <code>Main</code>,
and &#8220;Hello from Elsinore&#8221; is printed; next, the statement 
<code>Rosencrantz()</code>
causes the <code>Rosencrantz</code> routine to be executed. That continues until it 
ends with the close-routine marker <code>]</code>, 
whereupon execution goes back to <code>Main</code> just
after the point where it left off: since there is nothing more to do in 
<code>Main</code>, the interpreter stops. Thus, <code>Rosencrantz</code> 
is executed but <code>Hamlet</code> is not.</p>

<p class="indent">In fact, when the above source code is compiled, Inform notices 
that <code>Hamlet</code> is never needed and prints out a warning to that 
effect. The exact text produced by Inform varies from machine to machine, 
but will be something like this:</p>

<p class="lynxonly"></p>
<pre class="code">
RISC OS Inform 6.20 (10th December 1998)
line 8: Warning: Routine &quot;Hamlet&quot; declared but not used
Compiled with 1 warning
</pre>

<p class="normal">Errors are mistakes in the source which cause Inform 
to refuse to compile it, but this is only a warning. It alerts the programmer 
that a mistake may have been made (because presumably the programmer has 
simply forgotten to put in a statement calling <code>Hamlet</code>) but 
it doesn't prevent the compilation from taking place. Note that the opening 
line of the routine <code>Hamlet</code> occurs on the 8th line of the 
program above.</p>

<a id="p19" name="p19"></a>
<p class="indent">There are usually mistakes in a newly-written program 
and one goes through a cycle of running a first draft through Inform, 
receiving a batch of error messages, correcting the draft according to 
these messages, and trying again. A typical error message would occur 
if, on line 3, we had mistyped <code>Rosncrantz()</code> for 
<code>Rosencrantz().</code> Inform would then have produced:</p>

<p class="lynxonly"></p>
<pre class="code">
RISC OS Inform 6.20 (10th December 1998)
line 5: Warning: Routine &quot;Rosencrantz&quot; declared but not used
line 8: Warning: Routine &quot;Hamlet&quot; declared but not used
line 3: Error: No such constant as &quot;Rosncrantz&quot;
Compiled with 1 error and 2 warnings (no output)
</pre>

<p class="normal">The error message means that on line 3 Inform ran into a name which 
did not correspond to any known quantity: it's not the name of any 
routine, in particular. A human reader would immediately realise what 
was intended, but Inform doesn't, so that it goes on to warn that the 
routine <code>Rosencrantz</code> is never used. Warnings (and errors) 
are quite often produced as knock-on effects of other mistakes, so it is 
generally a good idea to worry about fixing errors first and warnings 
afterward.</p>

<p class="indent">Notice that Inform normally doesn't produce the final 
story file if errors occurred during compilation: this prevents it from 
producing damaged story files.</p>

<a id="s1_4" name="s1_4"></a>
<h3>&#167;1.4 &nbsp; Numbers and other constants</h3>

<p class="normal">Inform numbers are normally whole numbers in the range
&minus;32,768 to 32,767. (Special programming is needed to represent 
larger numbers or fractions, as we shall see when parsing phone numbers 
in <a href="ch4.html">Chapter IV</a>.) There are three notations 
for writing numbers in source code: here is an example of each.</p>

<p class="lynxonly"></p>
<pre class="code">
-4205
$3f08
$$1000111010110
</pre>

<p class="normal">The difference is the radix, or number base, in which 
they are expressed. The first is in decimal (base 10), the second hexadecimal 
(base 16, where the digits after 9 are written <code>a</code> to 
<code>f</code> or <code>A</code> to <code>F</code>) and the 
third binary (base 2). Once Inform has read in a number, it forgets which 
notation was used: for instance, if the source code is altered so that 
<code>$$10110</code> is replaced by <code>22</code>, this makes no
difference to the story file produced.</p>

<a id="p20" name="p20"></a>
<p class="indent">A print statement can print numbers as well as text, though it 
always prints them back in ordinary decimal notation. For example, the 
program</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main;
  print "Today's number is ", $3f08, ".^";
];
</pre>

<p class="normal">prints up</p>

<p class="output">Today's number is 16136.</p>

<p class="normal">since 16,136 in base 10 is the same number as 3f08 in 
hexadecimal.</p>

<p class="indent">Literal quantities written down in the source code are called 
&#8220;constants&#8221;. Numbers are one kind; strings of text like <code>"Today's number is "</code> are 
another. A third kind are characters, given between single quotation 
marks. For instance, <code>'x'</code> means &#8220;the letter lower-case x&#8221;.
A &#8220;character&#8221; is a single letter or typewriter-symbol.</p>

<p class="aside"><span class="warning">&#9650;</span>
Just as <code>$3f08</code> is a fancy way of writing the number 16,136,
so <code>'x'</code> is a fancy way of 
writing the number 120. The way characters correspond to numeric values is 
given by a code called ZSCII, itself quite close to the traditional computing standard 
called ASCII. 120 means &#8220;lower-case x&#8221; in ASCII, too, but ZSCII does its 
own thing with non-English characters like &#8220;&eacute;&#8221;. (You can type accented letters 
directly into source code: see <a href="#s1_11">&#167;1.11</a>.) The available 
characters and their ZSCII values are laid out in <a 
href="tables.html#tbl2a">Table 2</a>.</p>

<p class="indent">Inform also provides a few constants named for convenience, the 
most commonly used of which are true and false. A condition such as 
&#8220;the jewelled box is unlocked&#8221; will always have either the value true or 
the value false.</p>

<p class="aside"><span class="warning">&#9650;</span>
Once again these are numbers in disguise. <code>true</code> is 1, <code>false</code> 0.</p>

<p class="aside"><span class="warning">&#9650;</span>
Inform is a language designed with adventure games in mind, where a 
player regularly types in commands like &#8220;unlock the box&#8221;, using a fairly 
limited vocabulary. Writing a word like <code>'box'</code> in the source code, in single-quotation 
marks, adds it to the &#8220;dictionary&#8221; or vocabulary of the story file to be compiled. This is 
a kind of constant, too: you can use it for writing code like &#8220;if the second word typed 
by the player is <code>'box'</code>, then&#8230;&#8221;.</p>

<p class="aside"><span class="warning">&#9650;</span>
If you need to lodge a single-letter word (say &#8220;h&#8221;) into the dictionary, you 
can't put it in single quotes because then it would look like a character 
constant (<code>'h'</code>). Instead, the best you can write is <code>'h//'</code>. (The two slashes are 
sometimes used to tack a little linguistic information onto the end of a dictionary 
word, so that in some circumstances, see <a 
href="s29.html">&#167;29</a>, you might want to 
write <code>'pears//p'</code> to indicate that &#8220;pears&#8221;
must go into the dictionary marked as a plural. In this case the two 
slashes only serve to clarify that it isn't a character.)

<a id="p21" name="p21"></a>
<p class="aside"><span class="warning">&#9650;</span>
You can put an apostrophe ' into a dictionary word by writing it as ^: 
for instance <code>'helen^s'</code>.</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
In two places where dictionary words often appear, the name slot of an 
object definition and in grammar laid out with Verb and Extend, you're 
allowed to use single or double quotes interchangeably, and people sometimes 
do. For clarity's sake, this book tries to stick to using single quotes 
around dictionary words at all times. The handling of dictionary words 
is probably the single worst-designed bit of syntax in Inform, but you're 
past it now.</p>

<a id="s1_5" name="s1_5"></a>
<h3>&#167;1.5 &nbsp; Variables</h3>

<p class="normal">Unlike a literal number, a variable is able to vary. 
It is referred to by its name and, like the &#8220;memory&#8221; key on 
some pocket calculators, remembers the last value placed in it. For 
instance, if <code>oil_left</code> has been declared as a variable (see 
below), then the statement</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;There are &quot;, oil_left, &quot; gallons remaining.^&quot;;
</pre>

<p class="normal">would cause the interpreter to print &#8220;There are 
4 gallons remaining.&#8221; if <code>oil_left</code> happened to be 4, 
and so on. It's possible for the statement to be executed many times and 
produce different text at different times.</p>

<p class="indent">Inform can only know the named quantity <code>oil_left</code>
is to be a variable if the source code has &#8220;declared&#8221; that 
it is. Each routine can declare its own selection of up to 15 variables on 
its opening line. For example, in the program</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main alpha b;
  alpha = 2200;
  b = 201;
  print &quot;Alpha is &quot;, alpha, &quot; while b is &quot;, b, &quot;^&quot;;
];
</pre>

<p class="normal">the <code>Main</code> routine has two variables,
<code>alpha</code> and <code>b</code>.</p>

<p class="indent">Going back to the <code>Main</code> routine above, the <code>=</code> 
sign which occurs twice is an example of an &#8220;operator&#8221;: 
a notation usually made up of the symbols on the non-alphabetic 
keys on a typewriter and which means something is to be done with 
or calculated from the items it is written next to. Here <code>=</code> 
means &#8220;set equal to&#8221;. When the statement <code>alpha = 2200;</code> 
is interpreted, the current value of the variable <code>alpha</code> 
is changed to 2,200. It then keeps that value until another such 
statement changes it. All variables have the value 0 until they are 
first set.</p>

<a id="p22" name="p22"></a>
<p class="indent">The variables <code>alpha</code> and <code>b</code> 
are called &#8220;local variables&#8221; because they are local 
to <code>Main</code> and are its private property. The source code</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main alpha;
  alpha = 2200;
  Rival();
];

[ Rival;
  print alpha;
];
</pre>

<p class="normal">causes an error on the <code>print</code> statement in 
<code>Rival</code>, since <code>alpha</code> does not exist there. 
Indeed, <code>Rival</code> could even have defined a variable of its 
own also called <code>alpha</code> and this would have been an entirely 
separate variable.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">That's now two kinds of name: routines have names 
and so have variables. Such names, for instance <code>Rival</code> and 
<code>alpha</code>, are called &#8220;identifiers&#8221; and can be 
up to 32 characters long. They may contain letters of the alphabet, 
decimal digits or the underscore <code>_</code> character (often 
used to impersonate a space). To prevent them looking too much like 
numbers, though, they cannot start with a decimal digit. The following 
are examples of legal identifiers:</p>

<p class="lynxonly"></p>
<pre class="code">
turns_still_to_play     room101     X
</pre>

<p class="normal">Inform ignores any difference between upper and lower 
case letters in such names, so for instance <code>room101</code> is the 
same name as <code>Room101</code>.</p>

<a id="s1_6" name="s1_6"></a>
<h3>&#167;1.6 &nbsp; Arithmetic, assignment and bitwise operators</h3>

<p class="normal">The Inform language is rich with operators, as 
<a href="tables.html#tbl1a">Table 1</a> shows. This section introduces 
a first batch of them.</p>

<p class="indent">A general mixture of quantities and operators, designed 
to end up with a single resulting quantity, is called an &#8220;expression&#8221;. 
For example: the statement</p>

<p class="lynxonly"></p>
<pre class="code">
seconds = 60*minutes + 3600*hours;
</pre>

<p class="normal">sets the variable <code>seconds</code> equal to 60 
times the variable <code>minutes</code> plus 3600 times the variable 
<code>hours</code>. White space is not needed between operators and
<a id="p23" name="p23"></a>
&#8220;operands&#8221; (the quantities they operate on, such as 3600 and hours). 
The spaces on either side of the <code>+</code> sign were written in just for 
legibility.</p>

<p class="indent">The arithmetic operators are the simplest ones. To begin with, there 
are <code>+</code> (plus), <code>-</code> (minus), <code>*</code> (times)
and <code>/</code> (divide by). Dividing one whole number by 
another usually leaves a remainder: for example, 3 goes into 7 twice, 
with remainder 1. In Inform notation,</p>

<p class="output"><code>7/3</code> evaluates to 2 and
<code>7%3</code> evaluates to 1</p>

<p class="normal">the <code>%</code> operator meaning &#8220;remainder 
after division&#8221;, usually called 
just &#8220;remainder&#8221;.</p>

<p class="aside"><span class="warning">&#9650;</span>
The basic rule is that <code>a == (a/b)*b + (a%b)</code>, so that for 
instance:</p>

<p class="lynxonly"></p>
<pre class="code">
13/5 == 2    13/-5 == -2    -13/5 == -2    -13/-5 == 2
13%5 == 3    13%-5 == 3     -13%5 == -3    -13%-5 == -3
</pre>

<p class="normal"><span class="warning"><big><b>&#8226;</b></big> <b>WARNING</b></span><br>
Dividing by zero, and taking remainder after dividing by zero, are 
impossible. You must write your program so that it never tries to. It's worth a 
brief aside here on errors, because dividing by zero offers an example of how and 
when Inform can help the programmer to spot mistakes. The following source 
code:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main; print 73/0; ];
</pre>

<p class="normal">won't compile, because Inform can see that it definitely involves 
something illegal:</p>

<p class="lynxonly"></p>
<pre class="code">
line 2: Error: Division of constant by zero
&gt;   print 73/0;
</pre>

<p class="normal">However, Inform fails to notice anything amiss when compiling 
this:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main x; x = 0; print 73/x; ];
</pre>

<p class="normal">and this source code compiles correctly.
When the resulting story file is interpreted, however, the following will be 
printed:</p>

<p class="lynxonly"></p>
<pre class="code">
[** Programming error: tried to divide by zero **]
</pre>

<p class="normal">This is only one of about fifty different programming errors which can 
turn up when a story file is interpreted. As in this case, they arise when the 
interpreter has accidentally been asked to do something impossible. The moral is 
that just because Inform compiles source code without errors, it does not follow 
that the story file does what the programmer intended.</p>

<a id="p24" name="p24"></a>
<p class="aside"><span class="warning">&#9650;</span>
Since an Inform number has to be between &minus;32,768 and 32,767, 
some arithmetic operations overflow. For instance, multiplying 
8 by 5,040 ought to give 40,320, but this is over the top and the answer 
is instead &minus;25,216. Unlike dividing by zero, causing arithmetic 
overflows is perfectly legal. Some programmers make deliberate use of
overflows, for instance to generate apparently random numbers.</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
Only <em>apparently</em> random, because overflows are perfectly predictable. 
Inform story files store numbers in sixteen binary digits, so that when 
a number reaches 2<sup>16</sup> = 65,536 it clocks back round to zero 
(much as a car's odometer clocks over from 999999 miles to 000000). 
Now, since 65,535 is the value that comes before 0, it represents &minus;1, 
and 65,534 represents &minus;2 and so on. The result is that if you start 
with zero and keep adding 1 to it, you get 1, 2, 3, &#8230;, 
32,767 and then &minus;32,768, &minus;32,767, &minus;32,766, &#8230;,
&minus;1 and at last zero again. Here's how to predict an overflowing 
multiplication, say: first, multiply the two numbers as they stand, then 
keep adding or subtracting 65,536 from the result until it lies in 
the range &minus;32,768 to 32,767. For example, 8 multiplied by 
5,040 is 40,320, which is too big, but we only need to subtract 65,536 
once to bring it into range, and the result is
&minus;25,216.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">In a complicated expression the order in which the 
operators work may affect the result. As most human readers would, Inform 
works out both of</p>

<p class="lynxonly"></p>
<pre class="code">
3 + 2 * 6
2 * 6 + 3
</pre>

<p class="normal">as 15, because the operator <code>*</code> has 
&#8220;precedence&#8221; over <code>+</code> and so is acted on first.
Brackets may be used to overcome this:</p>

<p class="lynxonly"></p>
<pre class="code">
(3 + 2) * 6
2 * (6 + 3)
</pre>

<p class="normal">evaluate to 30 and 18 respectively. Each operator has 
such a &#8220;precedence level&#8221;. When two operators have the same 
precedence level (for example, <code>+</code> and <code>-</code> 
are of equal precedence) calculation is (almost always) &#8220;left 
associative&#8221;, that is, carried out left to right. So the notation 
<code>a-b-c</code> means <code>(a-b)-c</code> and not
<code>a-(b-c)</code>. The standard way to write formulae in maths 
is to give <code>+</code> and <code>-</code> equal precedence, 
but lower than that of <code>*</code> and <code>/</code> (which are 
also equal). Inform agrees and also pegs <code>%</code> equal to 
<code>*</code> and <code>/</code>.</p>

<p class="indent">The last purely arithmetic operator 
is &#8220;unary minus&#8221;. This is also written as a minus sign 
<code>-</code> but is not quite the same as subtraction. 
The expression:</p>

<p class="lynxonly"></p>
<pre class="code">-credit</pre>

<a id="p25" name="p25"></a>
<p class="normal">means the same thing as <code>0-credit</code>. The 
operator <code>-</code> is different from all those mentioned so far 
because it operates only on one value. It has higher precedence than 
any of the five other arithmetic operators. For example,</p>

<p class="lynxonly"></p>
<pre class="code">-credit - 5</pre>

<p class="normal">means <code>(-credit) - 5</code> and not 
<code>-(credit - 5)</code>.</p>

<p class="indent">One way to imagine precedence is to think of it as glue 
attached to the operator. A higher level means stronger glue. Thus, in</p>

<p class="lynxonly"></p>
<pre class="code">3 + 2 * 6</pre>

<p class="normal">the glue around the <code>*</code> is stronger than 
that around the <code>+</code>, so that 2 and 6 belong bound 
to the <code>*</code>.</p>

<p class="aside"><span class="warning">&#9650;</span>
Some languages have a &#8220;unary plus&#8221; too, but Inform hasn't.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">Some operators don't just work out values but actually 
change the current settings of variables: expressions containing these 
are called &#8220;assignments&#8221;. One such is &#8220;set 
equals&#8221;:</p>

<p class="lynxonly"></p>
<pre class="code">alpha = 72</pre>

<p class="normal">sets the variable <code>alpha</code> equal to 72. 
Like <code>+</code> and the others, it also comes up with an answer: 
which is the value it has set, in this case 72. The other two assignment 
operators are <code>++</code> and <code>--</code>, which will be 
familiar to any C programmer. They are unary operators, and mean 
&#8220;increase (or decrease) the value of this variable by one&#8221;. 
If the <code>++</code> or <code>--</code> goes before the variable, 
then the increase (or decrease) happens before the value is read 
off; if after, then after. For instance, if <code>variable</code> 
currently has the value 12 then:</p>

<p class="output"><code>variable++</code> evaluates to 12 and leaves 
<code>variable</code> set to 13;<br>
<code>++variable</code> evaluates to 13 and leaves <code>variable</code> 
set to 13;<br>
<code>variable--</code> evaluates to 12 and leaves <code>variable</code> 
set to 11;<br>
<code>--variable</code> evaluates to 11 and leaves <code>variable</code> 
set to 11.</p>

<p class="normal">These operators are provided as convenient shorthand 
forms, since their effect could usually be achieved in other ways. 
Note that expressions like</p>

<p class="lynxonly"></p>
<pre class="code">500++     (4*alpha)--     34 = beta</pre>

<p class="normal">are quite meaningless: the values of 500 and 34 
cannot be altered, and Inform knows no way to adjust <code>alpha</code> so as to 
make <code>4*alpha</code> decrease by 1. All three will cause 
compilation errors.</p>

<a id="p26" name="p26"></a>
<p class="dotbreak">· · · · ·</p>

<p class="normal">The &#8220;bitwise operators&#8221; are provided 
for manipulating binary numbers on a digit-by-digit basis, something 
which is only done in programs which are working with low-level data 
or data which has to be stored very compactly. Inform provides 
<code>&amp;</code>, bitwise AND, <code>|</code>, bitwise OR and 
<code>~</code>, bitwise NOT. For each digit, such an operator works out 
the value in the answer from the values in the operands. Bitwise NOT 
acts on a single operand and results in the number whose <i>i</i>-th 
binary digit is the opposite of that in the operand (a 1 for a 0, a 
0 for a 1). Bitwise AND (and OR) acts on two numbers and sets the
<i>i</i>-th digit to 1 if both operands have (either operand has)
<i>i</i>-th digit set. All Inform numbers are sixteen bits wide. So:</p>

<p class="lynxonly"></p>
<pre class="code">
$$10111100 &amp; $$01010001 == $$0000000000010000
$$10111100 | $$01010001 == $$0000000011111101
           ~ $$01010001 == $$1111111110101110
</pre>

<a id="s1_7" name="s1_7"></a>
<h3>&#167;1.7 &nbsp; Arguments and Return Values</h3>

<p class="normal">Here is one way to imagine how an Inform routine works: 
you feed some values into it, it then goes away and works on them, 
possibly printing some text out or doing other interesting things, and 
it then returns with a single value which it gives back to you. As far as 
you're concerned, the transaction consists of turning a group of starting 
values, called &#8220;arguments&#8221;, into a single &#8220;return
value&#8221;:</p>

<p style="text-align:center"><i>A</i><sub>1</sub>, <i>A</i><sub>2</sub>,
 <i>A</i><sub>3</sub>, &#8230; &rarr; Routine &rarr; <i>R</i></p>

<p class="normal">The number of arguments needed varies with the routine: 
some, like <code>Main</code> and the other routines in this chapter so 
far, need none at all. (Others need anything up to seven, which is the 
maximum number allowed by Inform.) On the other hand, every routine 
without exception produces a return value. Even when it looks as if 
there isn't one, there is. For example:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main;
  Sonnet();
];

[ Sonnet;
  print &quot;When to the sessions of sweet silent thought^&quot;;
  print &quot;I summon up remembrance of things past^&quot;;
];
</pre>

<a id="p27" name="p27"></a>
<p class="normal"><code>Main</code> and <code>Sonnet</code> both take 
no arguments, but they both return a value: as it happens this value 
is <code>true</code>, in the absence of any instruction to the 
contrary. (As was mentioned earlier, <code>true</code> is the same as 
the number 1.) The statement <code>Sonnet();</code> calls <code>Sonnet</code> 
but does nothing with the return value, which is just thrown away. 
But if <code>Main</code> had instead been written like so:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main;
  print Sonnet();
];
</pre>

<p class="normal">then the output would be</p>

<p class="output">When to the sessions of sweet silent thought<br>
I summon up remembrance of things past<br>1</p>

<p class="normal">because now the return value, 1, is not thrown away: 
it is printed out.</p>

<p class="indent">You can call it a routine with arguments by writing 
them in a list, separated by commas, in between the round brackets. 
For instance, here is a call supplying two arguments:</p>

<p class="lynxonly"></p>
<pre class="code">
Weather(&quot;hurricane&quot;, 12);
</pre>

<p class="normal">When the routine begins, the value <code>&quot;hurricane&quot;</code> is 
written into its first local variable, and the value <code>12</code> into 
its second. For example, suppose:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Weather called force;
  print &quot;I forecast a &quot;, (string) called, &quot; measuring force &quot;,
      force, &quot; on the Beaufort scale.^&quot;;
];
</pre>

<p class="normal">Leaving the details of the <code>print</code> statement aside 
for the moment, the call to this routine produces the text:</p>

<p class="output">I forecast a hurricane measuring force 12 on the Beaufort scale.</p>

<p class="normal">The <code>Weather</code> routine finishes when its 
<code>]</code> end-marker is reached, whereupon it returns <code>true</code>, 
but any of the following statements will finish a routine the moment 
they are reached:</p>

<p class="syntax"><code>rfalse;</code> &nbsp; &nbsp; &nbsp; which returns 
<code>false</code>,<br>
<code>rtrue;</code> &nbsp; &nbsp; &nbsp; which returns <code>true</code>,<br>
<a id="p28" name="p28"></a>
<code>return;</code> &nbsp; &nbsp; &nbsp; which also returns true,<br>
<code>return </code>&#8249;<span class="token">value</span>&#8250;<code>;</code> &nbsp; &nbsp; &nbsp; which returns &#8249;<span class="token">value</span>&#8250;.</p>

<p class="normal">For example, here is a routine to print out the cubes 
of the numbers 1 to 5:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main;
  print Cube(1), &quot; &quot;;
  print Cube(2), &quot; &quot;;
  print Cube(3), &quot; &quot;;
  print Cube(4), &quot; &quot;;
  print Cube(5), &quot;^&quot;;
];

[ Cube x;
  return x*x*x;
];
</pre>

<p class="normal">When interpreted, the resulting story file prints 
up the text:</p>

<p class="output">1 8 27 64 125</p>

<p class="aside"><span class="warning">&#9650;</span>
Any &#8220;missing arguments&#8221; in a routine call are set equal to 
zero, so the call <code>Cube()</code> is legal and does the same as 
<code>Cube(0)</code>. What you mustn't do is to give too many
arguments: <code>Cube(1,2)</code> isn't possible because there is no 
variable to put the 2 into.</p>

<p class="aside"><span class="warning">&#9650;</span>
A hazardous, but legal and sometimes useful practice is for a routine to 
call itself. This is called recursion. The hazard is that the following 
mistake can be made, probably in some much better disguised way:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Disaster; 
  return Disaster(); 
];
</pre>

<p class="aside">Despite the reassuring presence of the word <code>return</code>, 
execution is tied up forever, unable to finish evaluating the return 
value. The first call to <code>Disaster</code> needs to make a 
second before it can finish, the second needs to make a third, the 
third&#8230; and so on. (Actually, for &#8220;forever&#8221; read 
&#8220;until the interpreter runs out of stack space and halts&#8221;, 
but that's little comfort.)</p>

<a id="s1_8" name="s1_8"></a>
<h3>&#167;1.8 &nbsp; Conditions: <code>if</code>, <code>true</code> and <code>false</code></h3>

<p class="normal">The facilities described so far make Inform about as 
powerful as the average small programmable calculator. To make it a 
proper programming language, it needs much greater flexibility of action. 
This is provided by special statements
<a id="p29" name="p29"></a>
which control whether or not, and if so how many times 
or in what order, other statements are executed. The simplest is if:</p>

<p class="syntax"><code>if (</code>&#8249;<span class="token">condition</span>&#8250;<code>) </code>&#8249;<span class="token">statement</span>&#8250;</p>

<p class="normal">which executes the &#8249;<span class="token">statement</span>&#8250; only if the
&#8249;<span class="token">condition</span>&#8250;, when it is tested, turns out to be true. 
For example, when the statement</p>

<p class="lynxonly"></p>
<pre class="code">if (alpha == 3) print &quot;Hello&quot;;</pre>

<p class="normal">is executed, the word &#8220;Hello&#8221; is 
printed only if the variable <code>alpha</code> currently has 
value 3. It's important not to confuse the <code>==</code> (test 
whether or not equal to) with the <code>=</code> operator (set equal 
to). But because it's easy to write something plausible like</p>

<p class="lynxonly"></p>
<pre class="code">if (alpha = 3) print &quot;Hello&quot;;</pre>

<p class="normal">by accident, which always prints &#8220;Hello&#8221; 
because the condition evaluates to 3 which is considered non-zero 
and therefore true (see below), Inform will issue a warning if you try 
to compile something like this. (&#8216;<code>=</code>&#8217; used as condition: 
&#8216;<code>==</code>&#8217; intended?)</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">Conditions are always given in brackets. There are 
12 different conditions in Inform (see <a href="tables.html#tbl1a">Table 1</a>), 
six arithmetic and half a dozen to do with objects. Here are the 
arithmetic ones:</p>

<p class="lynxonly"></p>
<table style="margin-left:30px;margin-top:1em;margin-bottom:1em">
<tr><td valign="bottom"><code>(a == b)</code></td><td><code>a</code> equals <code>b</code></td></tr>
<tr><td valign="bottom"><code>(a ~= b)</code></td><td><code>a</code> doesn't equal <code>b</code></td></tr>
<tr><td valign="bottom"><code>(a &gt;= b)</code></td><td><code>a</code> is greater than or equal to <code>b</code></td></tr>
<tr><td valign="bottom"><code>(a &lt;= b)</code></td><td><code>a</code> is less than or equal to <code>b</code></td></tr>
<tr><td valign="bottom"><code>(a &gt; b)</code></td><td><code>a</code> is greater than <code>b</code></td></tr>
<tr><td valign="bottom"><code>(a &lt; b)</code></td><td><code>a</code> is less than <code>b</code></td></tr>
</table>

<p class="indent">A useful extension to this set is provided by the 
special operator <code>or</code>, which gives alternative 
possibilities. For example,</p>

<p class="lynxonly"></p>
<pre class="code">
if (alpha == 3 or 4) print &quot;Scott&quot;;
if (alpha ~= 5 or 7 or 9) print &quot;Amundsen&quot;;
</pre>

<p class="normal">where two or more values are given with the word 
or between. &#8220;Scott&#8221; is printed if <code>alpha</code> has 
value either 3 or 4, and &#8220;Amundsen&#8221; if the value of 
<code>alpha</code>
<a id="p30" name="p30"></a>
is not 5, is not 7 and is not 9. <code>or</code> can 
be used with any condition, and any number of alternatives can be 
given. For example</p>

<p class="lynxonly"></p>
<pre class="code">if (player in Forest or Village or Building) ...</pre>

<p class="normal">often makes code much clearer than writing three 
separate conditions out. Or you might want to use</p>

<p class="lynxonly"></p>
<pre class="code">if (x &gt; 100 or y) ...</pre>

<p class="normal">to test whether <code>x</code> is bigger than the 
minimum of 100 and <code>y</code>.</p>

<p class="indent">Conditions can also be built up from simpler ones 
using the three logical operators <code>&amp;&amp;</code>, 
<code>||</code> and <code>~~</code>, pronounced &#8220;and&#8221;, 
&#8220;or&#8221; and &#8220;not&#8221;. For example,</p>

<p class="lynxonly"></p>
<pre class="code">
if (alpha == 1 &amp;&amp; (beta &gt; 10 || beta &lt; -10)) print &quot;Lewis&quot;;
if (~~(alpha &gt; 6)) print &quot;Clark&quot;;
</pre>

<p class="normal">&#8220;Lewis&#8221; is printed if <code>alpha</code> 
equals 1 and <code>beta</code> is outside the range &minus;10 to 
10; &#8220;Clark&#8221; is printed if <code>alpha</code> is less 
than or equal to 6.</p>

<p class="aside"><span class="warning">&#9650;</span>
<code>&amp;&amp;</code> and <code>||</code> work left to right and 
stop evaluating conditions as soon as the final outcome is known. 
So for instance <code>if (A &amp;&amp; B) ...</code> 
will work out <code>A</code> first. If this is <code>false</code>, 
there's no need to work out <code>B</code>. This is sometimes called 
short-cut evaluation and can be convenient when working out conditions 
like</p>

<p class="lynxonly"></p>
<pre class="code">if (x~=nothing &amp;&amp; TreasureDeposited(x)==true) ...</pre>

<p class="aside">where you don't want <code>TreasureDeposited</code> 
to be called with the argument <code>nothing</code>.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">Conditions are expressions like any other, except 
that their values are always either <code>true</code> or 
<code>false</code>. You can write a condition as a value, say by 
copying it into a variable like so:</p>

<p class="lynxonly"></p>
<pre class="code">lower_caves_explored = (Y2_Rock_Room has visited);</pre>

<p class="normal">This kind of variable, storing a logical state, is 
traditionally called a &#8220;flag&#8221;. Flags are always either 
<code>true</code> or <code>false</code>: they are like the red flag 
over the beach at Lee-on-Solent in Hampshire, which is either flying, 
meaning that the army is using the firing range, or not flying, 
when it is safe to walk along the shore. Flags allow you to write
natural-looking code like:</p>

<p class="lynxonly"></p>
<pre class="code">if (lower_caves_explored) print &quot;You've already been that way.&quot;;</pre>

<p class="normal">The actual test performed by <code>if (x) ...</code> 
is <code>x~=0</code>, not that <code>x==true</code>, because all 
non-zero quantities are considered to represent truth whereas only 
zero represents falsity.</p>

<a id="p31" name="p31"></a>
<p class="dotbreak">· · · · ·</p>

<p class="aside"><span class="warning">&#9650;</span>
Now that the <code>if</code> statement is available, it's possible 
to give an example of a recursion that does work:</p>

<p class="lynxonly"></p>
<pre class="code">
[ GreenBottles n;
  print n, &quot; green bottles, standing on a wall.^&quot;;
  if (n == 0) print &quot;(And an awful lot of broken glass.)^&quot;;
  else {
      print &quot;And if one green bottle should accidentally fall^&quot;;
      print &quot;There'd be &quot;, n-1, &quot; green bottles.^&quot;;
      return GreenBottles(n-1);
  }
];
</pre>

<p class="aside">Try calling <code>GreenBottles(10)</code>. It prints 
the first verse of the song, then before returning it calls 
<code>GreenBottles(9)</code> to print the rest. So it goes on, until 
<code>GreenBottles(0)</code>. 
At this point <code>n</code> is zero, so the text &#8220;(And an awful lot of broken 
glass.)&#8221; is printed for the first and only time. <code>GreenBottles(0)</code> 
then returns back to <code>GreenBottles(1)</code>, which returns 
to <code>GreenBottles(2)</code>, which&#8230; and so on until 
<code>GreenBottles(10)</code> finally returns and the song is 
completed.</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
Thus execution reached &#8220;ten routines deep&#8221; before starting 
to return back up, and each of these copies of <code>GreenBottles</code> 
had its own private copy of the variable <code>n</code>. The limit 
to how deep you are allowed to go varies from one player's machine 
to another, but here is a rule of thumb, erring on the low side for 
safety's sake. (On a standard interpreter it will certainly be safe.) 
Total up 4 plus the number of its variables for each routine 
that needs to be running at the same time, and keep the total beneath 
1,000. Ten green bottles amounts only to a total of 10 × 5 = 50, 
and as it seems unlikely that anyone will wish to read the lyrics to 
&#8220;two hundred and one green bottles&#8221; the above recursion 
is safe.</p>

<a id="s1_9" name="s1_9"></a>
<h3>&#167;1.9 Code blocks, <code>else</code> and <code>switch</code></h3>

<p class="normal">A feature of all statements choosing what to do 
next is that instead of just giving a single &#8249;<span class="token">statement</span>&#8250;, 
one can give a list of statements grouped together into a unit called 
a &#8220;code block&#8221;. Such a group begins with an open brace 
<code>{</code> and ends with a close brace <code>}</code>. 
For example,</p>

<p class="lynxonly"></p>
<pre class="code">
if (alpha &gt; 5) {
    v = alpha*alpha;
    print &quot;The square of alpha is &quot;, v, &quot;.^&quot;;
}
</pre>

<a id="p32" name="p32"></a>
<p class="normal">If <code>alpha</code> is 3, nothing is printed; 
if <code>alpha</code> is 9,</p>

<p class="output">The square of alpha is 81.</p>

<p class="normal">is printed. (The indentation used in the source code, 
like all points of source code layout, is a matter of personal taste.&#8224;) 
In some ways, code blocks are like routines, and at first it may seem 
inconsistent to write routines between <code>[</code> and <code>]</code> 
brackets and code blocks between braces <code>{</code> and <code>}</code>. 
However, code blocks cannot have private variables of their own and do 
not return values; and it is possible for execution to break out of 
code blocks again, or to jump from block to block, which cannot happen 
with routines.</p>

<hr class="footnotebar">
<p class="aside" style="margin-top:0">&#8224;
Almost everybody indents each code block as shown, but the position 
of the open brace is a point of schism. This book adopts the &#8220;One 
True Brace Style&#8221;, as handed down in such sacred texts as the 
original Unix source code and Kernighan and Ritchie's textbook of C. 
Other conventions place the open brace vertically above its 
matching closure, perhaps on its own otherwise blank line of source 
code.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">An <code>if</code> statement can optionally have the form</p>

<p class="syntax"><code>if (</code> &#8249;<span class="token">condition</span>&#8250; <code>)</code>
&#8249;<span class="token">statement1</span>&#8250; <code>else</code> &#8249;<span class="token">statement2</span>&#8250;</p>

<p class="normal">whereupon &#8249;<span class="token">statement1</span>&#8250; is executed if the condition 
is true, and &#8249;<span class="token">statement2</span>&#8250; if it is false. For example,</p>

<p class="lynxonly"></p>
<pre class="code">if (alpha == 5) print &quot;Five.&quot;; else print &quot;Not five.&quot;;</pre>

<p class="normal">Note that the condition is only checked once, so that 
the statement</p>

<p class="lynxonly"></p>
<pre class="code">
if (alpha == 5) {
    print &quot;Five.&quot;;
    alpha = 10;
}
else 
    print &quot;Not five.&quot;;
</pre>

<p class="normal">cannot ever print both &#8220;Five&#8221; and 
then &#8220;Not five&#8221;.</p>

<p class="aside"><span class="warning">&#9650;</span>
The <code>else</code> clause has a snag attached: the problem of 
&#8220;hanging elses&#8221;. In the following, which <code>if</code> 
statement does the <code>else</code> attach to?</p>

<p class="lynxonly"></p>
<pre class="code">
if (alpha == 1) if (beta == 2)
    print &quot;Clearly if alpha=1 and beta=2.^&quot;;
else
    print &quot;Ambiguous.^&quot;;
</pre>

<a id="p33" name="p33"></a>
<p class="aside">Without clarifying braces, Inform pairs an <code>else</code> to 
the most recent <code>if</code>. (Much as the U.S. Supreme Court rigorously 
interprets muddled laws like &#8220;all animals must be licensed, 
except cats, other than those under six months old&#8221; by applying 
a so-called Last Antecedent Rule to ambiguous qualifications like this 
&#8220;other than&#8230;&#8221;.) The following version is much better 
style:</p>

<p class="lynxonly"></p>
<pre class="code">
if (alpha == 1) {
    if (beta == 2)
        print &quot;Clearly if alpha=1 and beta=2.^&quot;;
    else
        print &quot;Clearly if alpha=1 but beta not 2.^&quot;;
}
</pre>

<p class="dotbreak">· · · · ·</p>

<p class="normal">The <code>if</code> &#8230; <code>else</code> &#8230; 
construction is ideal for switching execution between two possible 
&#8220;tracks&#8221;, like railway signals, but it is a nuisance trying 
to divide between many different outcomes this way. To follow the 
analogy, the <code>switch</code> construction is like a railway 
turntable.</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;The train on platform 1 is going to &quot;;
switch (DestinationOnPlatform(1)) {
    1: print &quot;Dover Priory.&quot;;
    2: print &quot;Bristol Parkway.&quot;;
    3: print &quot;Edinburgh Waverley.&quot;;
    default: print &quot;a siding.&quot;;
}
</pre>

<p class="normal">The <code>default</code> clause is optional but must be placed last 
if at all: it is executed when the original expression matches none of 
the other values. Otherwise there's no obligation for these clauses 
to be given in numerical or any other order. Each possible alternative 
value must be a constant, so</p>

<p class="lynxonly"></p>
<pre class="code">
switch (alpha) {
    beta: print &quot;The variables alpha and beta are equal!&quot;;
}
</pre>

<p class="normal">will produce a compilation error. (But note that in 
a typical game, the name of an object or a location, such as
<code>First_Court</code>, is a constant, so there is no problem 
in quoting this as a switch value.)</p>

<a id="p34" name="p34"></a>
<p class="indent">Any number of outcomes can be specified, and values 
can be grouped together in lists separated by commas, or in ranges 
like 3 to 6. For example:</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;The mission Apollo &quot;, num, &quot; made &quot;;
switch (num) {
    7, 9: print &quot;a test-flight in Earth orbit.&quot;;
    8, 10: print &quot;a test-flight in lunar orbit.&quot;;
    11, 12, 14 to 17: print &quot;a landing on the Moon.&quot;;
    13: print &quot;it back safely after a catastrophic explosion.&quot;;
}
</pre>

<p class="normal">Each clause is automatically a code block, so a whole 
run of statements can be given without the need for any braces <code>{</code> 
and <code>}</code> around them.</p>

<p class="aside"><span class="warning">&#9650;</span>
If you're used to the C language, you might want to note a major 
difference: Inform doesn't have &#8220;case fall-through&#8221;, with 
execution running from one case to the next, so there's no need to 
use <code>break</code> statements.</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
A good default clause for the above example would be a little 
complicated: Apollo 1 was lost in a ground fire, causing a shuffle so 
that 2 and 3 never happened, while automatic test-flights of the Saturn 
rocket were unofficially numbered 4 to 6. Apollo 20 was cancelled 
to free up a heavy launcher for the Skylab station, and 18 and 19 
through budget cuts, though the Apollo/Soyuz Test Project (1975) is 
sometimes unhistorically called Apollo 18. The three Apollo flights to 
Skylab were called Skylab 2, 3 and 4. All six Mercury capsules were 
numbered 7, while at time of writing the Space Shuttle mission STS-88 
has just landed and the next to launch, in order, are projected to 
be 96, 93, 99, 103, 101 and 92. NASA has proud traditions.</p>

<a id="s1_10" name="s1_10"></a>
<h3>&#167;1.10 &nbsp; <code>while</code>, <code>do</code>&#8230;
<code>until</code>, <code>for</code>, <code>break</code>, 
<code>continue</code></h3>

<p class="normal">The other four Inform control constructions are all 
&#8220;loops&#8221;, that is, ways to repeat the execution of a given 
statement or code block. Discussion of one of them, called 
<code>objectloop</code>, is deferred until 
<a href="s3.html#s3_4">&#167;3.4</a>.</p>

<p class="indent">The two basic forms of loop are <code>while</code> 
and <code>do</code>&#8230;<code>until</code>:</p>

<p class="syntax"><code>while (</code>&#8249;<span class="token">condition</span>&#8250;<code>) </code>&#8249;<span class="token">statement</span>&#8250;<br>
<code>do </code>&#8249;<span class="token">statement</span>&#8250;<code> until (</code>&#8249;<span class="token">condition</span>&#8250;<code>)</code></p>

<p class="normal">The first repeatedly tests the condition and, 
provided it is still true, executes the statement. 
If the condition is not even true the first time, the statement is
<a id="p35" name="p35"></a>
never executed even once. For example:</p>

<p class="lynxonly"></p>
<pre class="code">
[ SquareRoot n x;
  while (x*x &lt; n) x = x + 1;
  if (x*x == n) return x;
  return x - 1;
];
</pre>

<p class="normal">which is a simple if rather inefficient way to find 
square roots, rounded down to the nearest whole number. If
<code>SquareRoot(200)</code> is called, then <code>x</code> runs 
up through the values 0, 1, 2, &#8230;, 14, 15, at which point <code>x*x</code> 
is 225: so 14 is returned. If <code>SquareRoot(0)</code> is called, 
the <code>while</code> condition never holds at all and so the return 
value is 0, made by the <code>if</code> statement.</p>

<p class="indent">The <code>do</code> &#8230; <code>until</code> loop 
repeats the given statement until the condition is found to be <code>true</code>. 
Even if the condition is already satisfied, like <code>(true)</code>, 
the statement is always executed the first time through.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">One particular kind of <code>while</code> loop is 
needed so often that there is an abbreviation for it, called 
<code>for</code>. This can produce any loop in the form</p>

<p class="syntax">&#8249;<span class="token">start</span>&#8250;<br>
<code>while (</code>&#8249;<span class="token">condition</span>&#8250;<code>) {</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code>&#8230;<br> 
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code>&#8249;<span class="token">update</span>&#8250;<br>
<code>}</code></p>

<p class="normal">where &#8249;<span class="token">start</span>&#8250; and &#8249;<span class="token">update</span>&#8250; are expressions 
which actually do something, such as setting a variable. The notation 
to achieve this is:</p>

<p class="syntax"><code>for (</code>&#8249;<span class="token">start</span>&#8250;<code> : </code>
&#8249;<span class="token">condition</span>&#8250;<code> : </code>&#8249;<span class="token">update</span>&#8250;<code>)</code> &#8230;</p>

<p class="normal">Note that if the condition is false the very first 
time, the loop is never executed. For instance, this prints nothing:</p>

<p class="lynxonly"></p>
<pre class="code">
for (counter=1 : counter&lt;0 : counter++) print &quot;Banana&quot;;
</pre>

<p class="normal">Any of the three parts of a <code>for</code> statement can 
be omitted. If the condition is missed out, it is assumed always <code>true</code>, 
so that the loop will continue forever, unless escaped by other means 
(see below).</p>

<p class="indent">For example, here is the <code>while</code> version 
of a common kind of loop:</p>

<p class="lynxonly"></p>
<pre class="code">
counter = 1;
while (counter &lt;= 10) {
    print counter, &quot; &quot;;
    counter++;
}
</pre>

<a id="p36" name="p36"></a>
<p class="normal">which produces the output &#8220;1 2 3 4 5 6 7 8 9 10&#8221;. 
(Recall that <code>counter++</code> adds 1 to the variable counter.) 
The abbreviated version is:</p>

<p class="lynxonly"></p>
<pre class="code">
for (counter=1 : counter&lt;=10 : counter++)
    print counter, &quot; &quot;;
</pre>

<p class="aside"><span class="warning">&#9650;</span>
Using commas, several assignments can be joined into one. For instance:</p>

<p class="lynxonly"></p>
<pre class="code">i++, score=50, j++</pre>

<p class="aside">is a single expression. This is never useful in 
ordinary code, where the assignments can be divided up by semicolons 
in the usual way. But in <code>for</code> loops it can be a convenience:</p>

<p class="lynxonly"></p>
<pre class="code">
for (i=1, j=5: i&lt;=5: i++, j--) 
    print i, &quot; &quot;, j, &quot;, &quot;;
</pre>

<p class="aside">produces the output &#8220;1 5, 2 4, 3 3, 4 2, 5 1,&#8221;.</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
Comma <code>,</code> is an operator, and moreover is the one with the 
lowest precedence level. The result of <code>a,b</code> is always 
<code>b</code>, but <code>a</code> and <code>b</code> are both evaluated and in that order.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">On the face of it, the following loops all repeat 
forever:</p>

<p class="syntax"><code>while (true) </code>&#8249;<span class="token">statement</span>&#8250;<br>
<code>do </code>&#8249;<span class="token">statement</span>&#8250;<code> until (false)</code><br>
<code>for (::) </code>&#8249;<span class="token">statement</span>&#8250;</p>

<p class="normal">But there is always an escape. One way is to return 
from the current routine. Another is to jump to a label outside the 
loop (see below), though if one only wants to escape the current loop 
then this is seldom good style. It's neatest to use the statement 
<code>break</code>, which means &#8220;break out of&#8221; the current 
innermost loop or <code>switch</code> statement: it can be read as 
&#8220;finish early&#8221;. All these ways out are entirely safe, 
and there is no harm in leaving a loop only half-done.</p>

<p class="indent">The other simple statement used inside loops is 
<code>continue</code>. This causes the current iteration to end immediately, 
but the loop then continues. In particular, inside a <code>for</code> 
loop, <code>continue</code> skips the rest of the body of the loop and 
goes straight to the update part. For example,</p>

<p class="lynxonly"></p>
<pre class="code">
for (i=1: i&lt;=5: i++) {
    if (i==3) continue;
    print i, &quot; &quot;;
}
</pre>

<p class="normal">will output &#8220;1 2 4 5&#8221;.</p>

<a id="p37" name="p37"></a>
<p class="dotbreak">· · · · ·</p>

<p class="aside"><span class="warning">&#9650;</span>
The following routine is a curious example of a loop which, though 
apparently simple enough, contains a trap for the unwary.</p>

<p class="lynxonly"></p>
<pre class="code">
[ RunPuzzle n count;
  do {
     print n, &quot; &quot;;
     n = NextNumber(n);
     count++;
  }
  until (n==1);
  print &quot;1^(taking &quot;, count, &quot; steps to reach 1)^&quot;;
];

[ NextNumber n;
  if (n%2 == 0) return n/2;     ! If n is even, halve it
  return 3*n + 1;               ! If n is odd, triple and add 1
];
</pre>

<p class="aside">The call <code>RunPuzzle(10)</code>, for example, 
results in the output</p>

<p class="output">10 5 16 8 4 2 1<br>
(taking 6 steps to reach 1)</p>

<p class="aside">The definition of <code>RunPuzzle</code> assumes 
that, no matter what the initial value of <code>n</code>, enough
iteration will end up back at 1. If this did not happen, the interpreter 
would lock up into an infinite loop, printing numbers forever. The 
routine is apparently very simple, so it would seem reasonable that 
by thinking carefully enough about it, we ought to be able to decide 
whether or not it will ever finish. But this is not so easy as it looks.
<code>RunPuzzle(26)</code> takes ten steps, but there again, 
<code>RunPuzzle(27)</code> takes 111. Can this routine ever lock up into 
an infinite loop, or not?</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
The answer, which caught the author by surprise, 
is: yes. Because of Inform's limited number range, eventually the 
numbers reached overflow 32,767 and Inform interprets them as negative 
&#8722; and quickly homes in on the cycle &#8722;1, &#8722;2, 
&#8722;1, &#8722;2,&#8230; This first happens to <code>RunPuzzle(447)</code>. 
Using proper arithmetic, unhindered by a limited number range, the 
answer is unknown. As a student in Hamburg in the 1930s, Lothar 
Collatz conjectured that every positive <code>n</code> eventually reaches 
1. Little progress has been made (though it is known to be true if 
<code>n</code> is less than 2<sup>40</sup>), and even Paul Erd&ouml;s
said of it that &#8220;Mathematics is not yet ready for such problems.&#8221; 
See Jeffrey Lagarias's bibliography <i>The</i> 3<i>x</i> + 1 <i>Problem 
and its Generalisations</i> (1996).</p>

<a id="p38" name="p38"></a>
<a id="s1_11" name="s1_11"></a>
<h3>&#167;1.11 &nbsp; How text is printed</h3>

<p class="normal">Adventure games take a lot of trouble over printing, 
so Inform is rich in features to make printing elegant output more easy. 
During story-file interpretation, your text will automatically be broken 
properly at line-endings. Inform story files are interpreted on screen 
displays of all shapes and sizes, but as a programmer you can largely 
ignore this. Moreover, Inform itself will compile a block of text spilling 
over several source-code lines into normally-spaced prose, so:</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;Here in her hairs
       the painter plays the spider, and hath woven
       a golden mesh t'untrap the hearts of men
       faster than gnats in cobwebs&quot;;
</pre>

<p class="normal">results in the line divisions being replaced by a single 
space each. The text printed is: <a href="s31.html">&#8220;Here 
in her hairs the painter plays the spider, and hath woven
a golden mesh&#8230;&#8221;</a> and so on. There is one exception to this: 
if a line finishes with a <code>^</code> (new-line) character, then no space is 
added.</p>

<p class="aside"><span class="warning">&#9650;</span>
You shouldn't type double-spaces after full stops or other punctuation, 
as this can spoil the look of the final text on screen. In particular, 
if a line break ends up after the first space of a double-space, the next 
line will begin with the second space. Since many typists habitually 
double-space, Inform has a switch <code>-d1</code> which contracts &#8220;.&nbsp;&nbsp;&#8221;
to &#8220;.&nbsp;&#8221; wherever it occurs, and then a further setting <code>-d2</code> 
which also contracts &#8220;!&nbsp;&nbsp;&#8221;
to &#8220;!&nbsp;&#8221; and &#8220;?&nbsp;&nbsp;&#8221;
to &#8220;?&nbsp;&#8221;. A modest warning, though: this can sometimes 
make a mess of diagrams. Try examining the 1851 Convention on Telegraphy 
Morse Code chart in &#8216;Jigsaw&#8217;, for instance, where the 
present author inadvertently jumbled the spacing because <code>-d</code> 
treated the Morse dots as full stops.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">When a string of text is printed up with <code>print</code>, 
the characters in the string normally appear exactly as given in the 
source code. However, four characters have special meanings. 
<code>^</code> means &#8220;print a new-line&#8221;. 
The tilde character <code>~</code>, meaning &#8220;print a quotation 
mark&#8221;, is needed since quotation marks otherwise finish strings. 
Thus,</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;~Look,~ says Peter. ~Socks can jump.~^Jane agrees.^&quot;;
</pre>

<p class="normal">is printed as</p>

<p class="output">&#8220;Look,&#8221; says Peter. 
&#8220;Socks can jump.&#8221;<br>Jane agrees.</p>

<a id="p39" name="p39"></a>
<p class="normal">The third remaining special character is <code>@</code>, 
occasionally used for accented characters and other unusual effects, 
as described below. Finally, <code>\</code> is reserved for 
&#8220;folding lines&#8221;, and is no longer needed but is retained 
so that old programs continue to work.</p>

<p class="aside"><span class="warning">&#9650;</span>
If you want to print an actual <code>~</code>, <code>^</code>, 
<code>@</code> or <code>\</code>, you may need one of the following
&#8220;escape sequences&#8221;. A double <code>@</code> sign followed 
by a decimal number means the character with the given ZSCII value, 
so in particular</p>

<p class="lynxonly"></p>
<table style="margin-left:30px">
<tr><td valign="bottom" style="padding-right:10px"><code>@@92</code></td>
<td style="padding-right:20px">comes out as &#8220;<code>\</code>&#8221;</td>
<td valign="bottom" style="padding-right:10px"><code>@@64</code></td>
<td>comes out as &#8220;<code>@</code>&#8221;</td></tr>
<tr><td valign="bottom" style="padding-right:10px"><code>@@94</code></td>
<td style="padding-right:20px">comes out as &#8220;<code>^</code>&#8221;</td>
<td valign="bottom" style="padding-right:10px"><code>@@126</code></td>
<td>comes out as &#8220;<code>~</code>&#8221;</td></tr></table>

<p class="dotbreak">· · · · ·</p>

<p class="normal">A number of Inform games have been written in European 
languages other than English, and even English-language games need 
accented letters from time to time. Inform can be told via command-line 
switches to assume that quoted text in the source code uses any of 
the ISO 8859-1 to -9 character sets, which include West and Central 
European forms, Greek, Arabic, Cyrillic and Hebrew. The default is ISO 
Latin-1, which means that you should be able to type most standard West 
European letters straight into the source code.</p>

<p class="aside"><span class="warning">&#9650;</span>
If you can't conveniently type foreign accents on your keyboard, or you 
want to make a source code file which could be safely taken from a PC 
to a Macintosh or vice versa, you can instead type accented characters 
using <code>@</code>. (The PC operating system Windows and Mac OS 
use incompatible character sets, but this incompatibility would only 
affect your source code. A story file, once compiled, behaves identically 
on PC and Macintosh regardless of what accented letters it may contain.) 
Many accented characters can be written as <code>@</code>, followed by 
an accent marker, then the letter on which the accent appears:</p>

<p class="syntax"><code>@^</code> &nbsp; put a circumflex on the next letter: a e i o u A E I O or U<br>
<code>@'</code> &nbsp; put an acute on the next letter: a e i o u y A E I O U or Y<br>
<code>@`</code> &nbsp; put a grave on the next letter: a e i o u A E I O or U<br>
<code>@:</code> &nbsp; put a diaeresis on the next letter: a e i o u A E I O or U<br>
<code>@c</code> &nbsp; put a cedilla on the next letter: c or C<br>
<code>@~</code> &nbsp; put a tilde on the next letter: a n o A N or O<br>
<code>@\</code> &nbsp; put a slash on the next letter: o or O<br>
<code>@o</code> &nbsp; put a ring on the next letter: a or A</p>

<p class="aside">A few other letter-forms are available: German &#223; (<code>@ss</code>), 
ligatures (<code>@oe</code>, <code>@ae</code>, <code>@OE</code>, 
<code>@AE</code>), Icelandic &#8220;thorn&#8221; <code>@th</code> 
and &#8220;eth&#8221; <code>@et</code>, a pounds-sterling sign 
(<code>@LL</code>), Spanish inverted punctuation (<code>@!!</code> and 
<code>@??</code>) and continental European quotation marks 
(<code>@&lt;&lt;</code> and <code>@&gt;&gt;</code>): see 
<a href="tables.html#tbl2a">Table 2</a>. For instance,</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;Les @oeuvres d'@AEsop en fran@ccais, mon @'el@`eve!&quot;;
print &quot;Na@:ive readers of the New Yorker re@:elected Mr Clinton.&quot;;
print &quot;Gau@ss first proved the Fundamental Theorem of Algebra.&quot;;
</pre>

<a id="p40" name="p40"></a>
<p class="aside">Accented characters can also be referred to as constants, 
like other characters. Just as <code>'x'</code> represents the character 
lower-case-X, so <code>'@^A'</code> represents capital-A-circumflex.</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
It takes a really, really good interpreter with support built in for 
Unicode and access to the proper fonts to use such a story file, but 
in principle you can place any Unicode character into text by quoting its 
Unicode value in hexadecimal. For instance, <code>@{a9}</code> produces a copyright 
sign (Unicode values between <code>$0000</code> and <code>$00ff</code> 
are equal to ISO Latin1 values); <code>@{2657}</code> is a White bishop 
chess symbol; <code>@{274b}</code> is a &#8220;heavy eight teardrop-spoked 
propeller asterisk&#8221;; <code>@{621}</code> is the Arabic letter 
Hamza, and so on for around 30,000 more, including vast sets for Pacific 
Rim scripts and even for invented ones like Klingon or Tolkien's Elvish. 
Of course none of these new characters are in the regular ZSCII set, 
but ZSCII is configurable using Inform's Zcharacter directive. 
See <a href="s36.html">&#167;36</a> for more.</p>

<p class="dotbreak">· · · · ·</p>

<p class="aside"><span class="warning">&#9650;</span>
The remaining usage of <code>@</code> is hacky but powerful. Suppose 
you are trying to implement some scenes from Infocom's spoof of 1930s 
sci-fi, &#8216;Leather Goddesses of Phobos&#8217;, where one of the 
player's companions has to be called Tiffany if the player is female, 
and Trent if male. The name turns up in numerous messages and it would 
be tiresome to keep writing</p>

<p class="lynxonly"></p>
<pre class="code">if (female_flag) print &quot;Tiffany&quot;; else print &quot;Trent&quot;;</pre>

<p class="aside">Instead you can use one of Inform's 32 &#8220;printing-variables&#8221; 
<code>@00</code> to <code>@31</code>. When the text <code>@14</code> 
is printed, for instance, the contents of string 14 are substituted in. 
The contents of string 14 can be set using the <code>string</code> statement, 
so:</p>

<p class="lynxonly"></p>
<pre class="code">
if (female_flag) string 14 &quot;Tiffany&quot;; else string 14 &quot;Trent&quot;;
...
print &quot;You offer the untangling cream to @14, who whistles.^&quot;;
</pre>

<p class="aside">The value specified by a <code>string</code> statement 
has to be a literal, constant bit of text. There are <em>really</em> 
hacky ways to get around this, but if you needed to then you'd probably 
be better off with a different solution anyway.</p>

<a id="s1_12" name="s1_12"></a>
<h3>&#167;1.12 &nbsp; The <code>print</code> and <code>print_ret</code> 
statements</h3>

<p class="normal">The <code>print</code> and <code>print_ret</code> 
statements are almost identical. The difference is that the second 
prints out a final and extra new-line character, and then causes a 
return from the current routine with the value <code>true</code>. Thus, 
<code>print_ret</code> should be read as &#8220;print this, print a 
new-line and then return <code>true</code>&#8221;, and so</p>

<p class="lynxonly"></p>
<pre class="code">print_ret &quot;That's enough of that.&quot;;</pre>

<a id="p41" name="p41"></a>
<p class="normal">is equivalent to</p>

<p class="lynxonly"></p>
<pre class="code">print &quot;That's enough of that.^&quot;; rtrue;</pre>

<p class="normal">As an abbreviation, it can even be shortened to:</p>

<p class="lynxonly"></p>
<pre class="code">&quot;That's enough of that.&quot;;</pre>

<p class="normal">Although Inform newcomers are often confused by the 
fact that this innocently free-standing bit of text actually causes 
a return from the current routine, it's an abbreviation which pays 
dividends in adventure-writing situations:</p>

<p class="lynxonly"></p>
<pre class="code">
if (fuse_is_lit) { deadflag = true; &quot;The bomb explodes!&quot;; }
&quot;Nothing happens.&quot;;
</pre>

<p class="normal">Note that if the source code:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main;
  &quot;Hello, and now for a number...&quot;;
  print 21*764;
];
</pre>

<p class="normal">is compiled, Inform will produce the warning 
message:</p>

<p class="lynxonly"></p>
<pre class="code">
line 3: Warning: This statement can never be reached.
&gt;   print 21*764;
</pre>

<p class="normal">because the bare string on line 2 is printed using 
<code>print_ret</code>: so the text is printed, then a new-line is printed, 
and then a return takes place immediately. As the warning message indicates, 
there is no way the statement on line 3 can ever be executed.</p>

<p class="indent">So what can be printed? The answer is a list of 
terms, separated by commas. For example,</p>

<p class="lynxonly"></p>
<pre class="code">print &quot;The value is &quot;, value, &quot;.&quot;;</pre>

<p class="normal">contains three terms. A term can take the following 
forms:</p>

<p class="lynxonly"></p>
<table style="margin-left:30px;margin-top:1em;margin-bottom:1em">
<tr><td>&#8249;<span class="token">a value</span>&#8250;</td>
<td>printed as a (signed, decimal) number</td></tr>
<tr><td>&#8249;<span class="token">text in double-quotes</span>&#8250;</td>
<td>printed as text</td></tr>
<tr><td><code>(</code>&#8249;<span class="token">rule</span>&#8250;<code>)</code> &#8249;<span class="token">value</span>&#8250;</td>
<td>printed according to some special rule</td></tr></table>

<p class="normal">Inform provides a stock of special printing rules 
built-in, and also allows the programmer to create new ones. The most 
important rules are:</p>

<p class="lynxonly"></p>
<table style="margin-left:30px;margin-top:1em;margin-bottom:1em">
<tr><td valign="bottom"><code>(char)</code></td>
<td>print out the character which this is the ZSCII code for</td></tr>
<tr><td valign="bottom"><code>(string)</code></td>
<td>print out this string</td></tr>
<tr><td valign="bottom"><code>(address)</code></td>
<td>print out the text of this dictionary word</td></tr>
<tr><td valign="bottom"><code>(name)</code></td>
<td>print out the name of this object (see <a href="s3.html">&#167;3</a>)</td></tr>
</table>

<p class="normal">Games compiled with the Inform library have several 
other printing rules built-in (like <code>print (The)</code> 
&#8230;), but as these aren't part of the Inform language as such 
they will be left until <a href="s26.html">&#167;26</a>.</p>

<a id="p42" name="p42"></a>
<p class="aside"><span class="warning">&#9650;</span>
<code>print (string)</code> &#8230; requires a little explanation. Of 
the following lines, the first two print out &#8220;Hello!&#8221; 
but the third prints only a mysterious number:</p>

<p class="lynxonly"></p>
<pre class="code">
print (string) &quot;Hello!&quot;;
x = &quot;Hello!&quot;; print (string) x;
x = &quot;Hello!&quot;; print x;
</pre>

<p class="aside">This is because strings are internally represented by 
mysterious numbers. <code>print (string)</code> means &#8220;interpret 
this value as the mysterious number of a string, and print out 
that string&#8221;: it is liable to give an error, or in some cases 
print gibberish, if applied to a value which isn't the mysterious 
number of any string.</p>

<p class="dotbreak">· · · · ·</p>

<p class="normal">Any Inform program can define its own printing rules 
simply by providing a routine whose name is the same as that of the 
rule. For example, the following pair of routines provides for printing 
out a value as a four-digit, unsigned hexadecimal number:</p>

<p class="lynxonly"></p>
<pre class="code">
[ hex x y;
  y = (x &amp; $7f00) / $100;
  if (x&lt;0) y = y + $80;
  x = x &amp; $ff;
  print (hexdigit) y/$10, (hexdigit) y,
        (hexdigit) x/$10, (hexdigit) x;
];

[ hexdigit x;
  x = x % $10;
  switch (x) {
      0 to 9: print x;
      10: print &quot;a&quot;;  11: print &quot;b&quot;;  12: print &quot;c&quot;;
      13: print &quot;d&quot;;  14: print &quot;e&quot;;  15: print &quot;f&quot;;
  }
];
</pre>

<p class="normal">You can paste these two routines into any Inform 
source code to make these new printing rules <code>hex</code> and 
<code>hexdigit</code> available to that code. For example,
<code>print (hex) 16339;</code> will then print up &#8220;3fd3&#8221;, 
and <code>print (hex) -2;</code> will print &#8220;fffe&#8221;. 
Something to look out for is that if you inadvertently write</p>

<p class="lynxonly"></p>
<pre class="code">print hex(16339);</pre>

<p class="normal">then the text printed will be &#8220;3fd31&#8221;, 
with a spurious 1 on the end: because you've printed out the 
return value of the routine <code>hex</code>, which was <code>true</code>, 
or in other words 1.</p>

<a id="p43" name="p43"></a>
<a id="s1_13" name="s1_13"></a>
<h3>&#167;1.13 &nbsp; Other printing statements</h3>

<p class="normal">Besides <code>print</code> and <code>print_ret</code>, 
several other statements can also be used for printing.</p>

<p class="lynxonly"></p>
<pre class="code">new_line</pre>

<p class="normal">prints a new-line, otherwise known as a 
carriage return (named for the carriage which used to move paper across 
a typewriter). This is equivalent to</p>

<p class="lynxonly"></p>
<pre class="code">print &quot;^&quot;</pre>

<p class="normal">but is a convenient abbreviation. Similarly,</p>

<p class="syntax"><code>spaces</code> &#8249;<span class="token">number</span>&#8250;</p>

<p class="normal">prints a sequence of the given number of spaces.</p>

<p class="syntax"><code>box</code> &#8249;<span class="token">string1</span>&#8250; &#8230;
&#8249;<span class="token">stringn</span>&#8250;</p>

<p class="normal">displays a reverse-video panel in the centre of 
the screen, containing each string on its own line. For example, 
the statement</p>

<p class="lynxonly"></p>
<pre class="code">box &quot;Passio domini nostri&quot; &quot;Jesu Christi Secundum&quot; &quot;Joannem&quot;;</pre>

<p class="normal">displays the opening line of the libretto to Arvo 
P&auml;rt's &#8216;St John Passion&#8217;:</p>

<p class="lynxonly"></p>
<table align="center" style="border:1px solid black;margin-top:1em">
<tr><td>Passio domini nostri<br>
Jesu Christi Secundum<br>Joannem</td></tr></table>

<p class="dotbreak">· · · · ·</p>

<p class="normal">Text is normally displayed in an unembellished 
but legible type intended to make reading paragraphs comfortable. Its 
actual appearance will vary from machine to machine running the story 
file. On most machines, it will be displayed using a &#8220;font&#8221; 
which is variably-pitched, so that for example a &#8220;w&#8221;
will be wider on-screen than an &#8220;i&#8221;. Such text is much 
easier to read, but makes it difficult to print out diagrams. The 
statement</p>

<p class="lynxonly"></p>
<pre class="code">
print &quot;+------------+
      ^+   Hello    +
      ^+------------+^&quot;;
</pre>

<a id="p44" name="p44"></a>
<p class="normal">will print something irregular if the letters 
in &#8220;Hello&#8221; and the characters &#8220;-&#8221;,
&#8220;+&#8221; and &#8220;&nbsp;&#8221; (space) do not all have 
the same width on-screen:</p>

<p class="output">+------------+<br>
+&nbsp;&nbsp;&nbsp;Hello&nbsp;&nbsp;&nbsp;&nbsp;+<br>
+------------+</p>

<p class="normal">Because one sometimes does want to print such a diagram, 
to represent a sketch-map, say, or to print out a table, the statement 
<code>font</code> is provided:</p>

<p class="lynxonly"></p>
<pre class="code">
font on
font off
</pre>

<p class="normal"><code>font off</code> switches into a fixed-pitch 
display style. It is now guaranteed that the interpreter will print 
all characters at the same width. <code>font on</code> restores 
the usual state of affairs.</p>

<p class="indent">In addition, you can choose the type style from a 
small set of possibilities: roman (the default), boldface, underlined 
or otherwise emphasized (some interpreters will use italic for this), 
reverse-colour:</p>

<p class="lynxonly"></p>
<pre class="code">
style roman
style bold
style underline
style reverse
</pre>

<p class="normal">&#8220;Reverse colour&#8221; would mean, for instance, 
yellow on blue if the normal text appearance happened to be blue on 
yellow. An attempt will be made to approximate these effects whatever 
kind of machine is running the story file.</p>

<p class="aside"><span class="warning">&#9650;</span>
Changes of foreground and background colours, so memorably used in games
like Adam Cadre's &#8216;Photopia&#8217;, can be achieved with care 
using Z-machine assembly language. See <a href="s42.html">&#167;42</a>.</p>

<a id="s1_14" name="s1_14"></a>
<h3>&#167;1.14 &nbsp; Generating random numbers</h3>

<p class="normal">Inform provides a small stock of functions ready-defined, 
but which are used much as other routines are. As most of these concern 
objects, only one will be given here: <code>random</code>, which has 
two forms:</p>

<p class="lynxonly"></p>
<pre class="code">random(N)</pre>

<a id="p45" name="p45"></a>
<p class="normal">returns a random number in the range 1, 2, &#8230;,
<code>N</code>, each of these outcomes being (in theory) equally 
likely. <code>N</code> should be a positive number, between 1 and
32,767, for this to work properly.</p>

<p class="syntax"><code>random(</code>&#8249;<span class="token">two or more constant quantities, separated by commas</span>&#8250;<code>)</code></p>

<p class="normal">returns a random choice from the given selection of 
constant values. Thus,</p>

<p class="lynxonly"></p>
<pre class="code">print (string) random(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;violet&quot;);</pre>

<p class="normal">prints the name of one of these four colours at random. 
Likewise,</p>

<p class="lynxonly"></p>
<pre class="code">print random(13, 17);</pre>

<p class="normal">has a 50% chance of printing &#8220;13&#8221;, and 
a 50% chance of printing &#8220;17&#8221;.</p>

<p class="aside"><span class="warning">&#9650;</span>
Random numbers are produced inside the interpreter by a &#8220;generator&#8221; 
which is not truly random in its behaviour. Instead, the sequence of 
numbers it produces depend on a value inside the generator called 
the &#8220;seed&#8221;. Setting this value is called &#8220;seeding
the random-number generator&#8221;. Whenever it has the same seed value, 
the same sequence of random values will be harvested. This is called 
&#8220;pseudo-randomness&#8221;. An interpreter normally goes to some 
effort to start up with a seed value which is unpredictable: say, 
the current time of day in milliseconds. Because you just might want 
to make it predictable, though, you can change the seed value within 
the story file by calling <code>random(N)</code> for a negative 
number <code>N</code> of your own choosing. (This returns zero.) 
Seeding is sometimes useful to test a game which contains random 
events or delays. For example if you have release 29 of Infocom's 
game &#8216;Enchanter&#8217;, you may be surprised to know that you 
can type &#8220;#random 14&#8221; into it, after which its random
events will be repeatable and predictable. Internally, &#8216;Enchanter&#8217; 
does this by calling <code>random(-14)</code>.</p>

<a id="s1_15" name="s1_15"></a>
<h3>&#167;1.15 &nbsp; Deprecated ways to jump around</h3>

<p class="normal">There are four statements left which control the 
flow of execution, but one should try to avoid using any of them if, 
for instance, a <code>while</code> loop would do the job more tidily. 
Please stop reading this section now.</p>

<p class="aside"><span class="warning">&#9650;</span>
Oh very well. &#8216;Deprecated&#8217; is too strong a word, anyway, 
as there are circumstances where jumping is justified and even 
elegant: to break out of several loops at once, for instance, 
or to construct a finite state machine. It's the <em>gratuitous</em> 
use of jumping which is unfortunate, as this rapidly decreases the 
legibility of the source code.</p>

<a id="p46" name="p46"></a>
<p class="aside"><span class="warning">&#9650;</span>
The <code>jump</code> statement transfers execution 
to some named place in the same routine. (Some programming languages 
call this <code>goto</code>.) To use <code>jump</code> a notation 
is needed to mark particular places in the source code. Such markers 
are called &#8220;labels&#8221;. For example, here is a never-ending 
loop made by hand:</p>

<p class="lynxonly"></p>
<pre class="code">
[ Main i;
  i=1;
  .Marker;
  print &quot;I have now printed this &quot;, i++, &quot; times.^&quot;;
  jump Marker;
];
</pre>

<p class="aside">This routine has one label, <code>Marker</code>. A 
statement consisting only of a full stop and then an identifier means 
&#8220;put a label here and call it this&#8221;. Like local variables, 
labels belong to the routines defining them and cannot be used by 
other routines.</p>

<p class="aside"><span class="warning">&#9650;</span>
The <code>quit</code> statement ends interpretation of the story file 
immediately, as if a return had taken place from the <code>Main</code> 
routine. This is a drastic measure, best reserved for error
conditions so awful that there is no point carrying on.</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
An Inform story file has the ability to save a snapshot of its entire 
state and to restore back to that previous state. This snapshot includes 
values of variables, the point where code is currently being executed, 
and so on. Just as we cannot know if the universe is only six thousand 
years old, as creationists claim, having been endowed by God with a 
carefully faked fossil record, so an Inform story file cannot know if 
it has been executing all along or if it was only recently restarted. 
The statements required are <code>save</code> and <code>restore</code>:</p>

<p class="syntax"><code>save</code> &#8249;<span class="token">label</span>&#8250;<br>
<code>restore</code> &#8249;<span class="token">label</span>&#8250;</p>

<p class="aside">This is a rare example of an Inform feature which may 
depend on the host machine's state of health: for example, if all disc 
storage is full, then <code>save</code> will fail. It should always
be assumed that these statements may well fail. A <code>jump</code> to 
the label provided occurs if the operation has been a success. 
This is irrelevant in the case of a <code>restore</code> since, if
all has gone well, execution is now resuming from the successful branch 
of the <code>save</code> statement: because that is where execution was 
when the state was saved.</p>

<p class="aside"><span class="warning">&#9650;&#9650;</span>
If you don't mind using assembly language (see 
<a href="s42.html">&#167;42</a>), you can imitate exceptions,
in the sense of programming languages like Java. The opcodes you would 
need are <code>@throw</code> and <code>@catch</code>.</p>

<p class="aside"><span class="warning"><b>&#8226;</b> <b>REFERENCES</b></span><br>
If you need to calculate with integers of any size then the restriction 
of Inform numbers to the range &#8722;32,768 to 32,767 is a nuisance. 
The function library <code>&quot;longint.h&quot;</code>, by 
Chris Hall and Francis Irving, provides routines to calculate with 
signed and unsigned
<a id="p47" name="p47"></a>
4-byte integers, increasing the range to about
&#177;2,147,000,000. &nbsp; <span class="warning"><b>&#8226;</b></span>L. Ross 
Raszewski's function library <code>&quot;ictype.h&quot;</code> 
is an Inform version of the ANSI C routines <code>&quot;ctype.h&quot;</code>,
which means that it contains routines to test whether a given character 
is lower or upper case, or is a punctuation symbol, and so forth. (See 
also the same author's <code>&quot;istring.h&quot;</code>.)

</div>
<p class="navbar">
 <a href="index.html">home</a> /
 <a href="contents.html">contents</a> /
 <a href="ch1.html" title="Chapter I: The Inform Language">chapter I</a> /
 <a href="ch1.html" title="Chapter I: The Inform Language">prev</a> /
 <a href="s2.html" title="&#167;2: The state of play">next</a> /
 <a href="dm4index.html">index</a>
</p>
</body>
</html>
